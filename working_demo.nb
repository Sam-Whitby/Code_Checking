(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    284507,       7041]
NotebookOptionsPosition[    280400,       6977]
NotebookOutlinePosition[    280797,       6993]
CellTagsIndexPosition[    280754,       6990]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Code. First cell is symbolic checker for parameters.", "Chapter",
 CellChangeTimes->{{3.978091221335834*^9, 3.978091222951585*^9}, {
  3.978092250712267*^9, 
  3.978092275814818*^9}},ExpressionUUID->"49c23e43-c169-4232-b701-\
8d3112396739"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SETUP", "-", 
    RowBox[{"DEFINE", " ", "SYSTEM", " ", "PARAMETERS"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "4"}], ";"}], "              ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Lattice", " ", "size"}], "-", 
    RowBox[{
    "number", " ", "of", " ", "sites", " ", "on", " ", "the", " ", "ring"}]}],
    "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nParticles", "=", "2"}], ";"}], "     ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "distinguishable", " ", "particles", " ", "to", " ",
     "place", " ", "on", " ", "lattice"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "=", 
    RowBox[{"Symbol", "[", "\"\<\[Beta]\>\"", "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Inverse", " ", "temperature"}], "-", 
    RowBox[{"kept", " ", "symbolic"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "SELECT", " ", "WHICH", " ", "KAWASAKI", " ", "FUNCTION", " ", "TO", " ", 
    "USE"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TESTFUNCTION", "=", "KawasakiMoveFromBitsDB"}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "Change", " ", "to", " ", "KawasakiMoveFromBits2", " ", "to", " ", 
    "switch"}], "*)"}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "SPECIFY", " ", "NUMBER", " ", "OF", " ", "EXTRA", " ", "RANDOM", " ", 
    "BITS", " ", "FOR", " ", "THE", " ", "MOVE"}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "nExtraBits", " ", "controls", " ", "the", " ", "complexity", " ", "of", " ",
      "the", " ", 
     RowBox[{"move", ":", 
      RowBox[{"-", "0"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"standard", " ", "Kawasaki", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"just", " ", "nearest"}], "-", 
         RowBox[{"neighbor", " ", "swap"}]}], ")"}]}], "-", "1"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"enhanced", " ", "moves", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", ".", "g", "."}], ",", "reversal", ",", "translation"}],
          ")"}]}], "-", "2", "+"}], " ", "=", 
      RowBox[{
      "even", " ", "more", " ", "complex", " ", "moves", " ", "requiring", " ",
        "multiple", " ", "decision", " ", "bits"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nExtraBits", "=", "0"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<L = \>\"", ",", "L"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<nParticles = \>\"", ",", "nParticles"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Extra bits for moves: \>\"", ",", "nExtraBits"}], "]"}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SYMBOLIC", " ", "J", " ", "MATRIX"}], "-", 
    RowBox[{"INTERACTION", " ", "ENERGIES"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Generates", " ", "a", " ", "symmetric", " ", "matrix", " ", "of", " ", 
      "symbolic", " ", "coupling", " ", "constants", " ", "J_ij", " ", "J_ij",
       " ", "represents", " ", "the", " ", "interaction", " ", "energy", " ", 
      "between", " ", "particle", " ", "types", " ", "i", " ", "and", " ", 
      "j", " ", "Matrix", " ", "is", " ", 
      RowBox[{"(", 
       RowBox[{"nParticles", "+", "1"}], ")"}], " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{"nParticles", "+", "1"}], ")"}], " ", "to", " ", "include", " ",
       "empty", " ", "sites", " ", 
      RowBox[{"(", 
       RowBox[{"type", " ", "0"}], ")"}], " ", "Example", " ", "for", " ", 
      "nParticles"}], "=", 
     RowBox[{"2", ":", 
      RowBox[{"creates", " ", "J01"}]}]}], ",", "J02", ",", 
    RowBox[{"J12", " ", "as", " ", "symbolic", " ", "variables"}]}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateSymbolicJ", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"J", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"n", "+", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "<", "j"}], ",", 
          RowBox[{"(*", 
           RowBox[{
           "Create", " ", "symbolic", " ", "variable", " ", "for", " ", 
            "interaction"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"J", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<J\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", 
              RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Make", " ", "matrix", " ", "symmetric"}], "*)"}], 
           RowBox[{
            RowBox[{"J", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"j", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"J", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "J"}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"JMatrix", "=", 
    RowBox[{"GenerateSymbolicJ", "[", "nParticles", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<J Matrix:\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"JMatrix", "//", "MatrixForm"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ENERGY", " ", "FUNCTION"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Calculates", " ", "the", " ", "energy", " ", "of", " ", "a", " ", 
     "lattice", " ", "configuration", " ", "Energy"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[CapitalSigma]"}], " ", "J", 
      RowBox[{"(", 
       RowBox[{"particle_i", ",", "particle_j"}], ")"}], " ", "for", " ", 
      "all", " ", "nearest"}], "-", 
     RowBox[{
     "neighbor", " ", "pairs", " ", "Uses", " ", "periodic", " ", "boundary", 
      " ", "conditions", " ", 
      RowBox[{"(", 
       RowBox[{"ring", " ", "topology"}], ")"}], " ", "Only", " ", "counts", " ",
       "interactions", " ", "between", " ", "occupied", " ", "sites", " ", 
      RowBox[{"(", 
       RowBox[{"non", "-", 
        RowBox[{"zero", " ", "particles"}]}], ")"}]}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SymbolicEnergy", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"E", "=", "0"}], ",", "i", ",", "j"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{"(*", 
        RowBox[{
        "Get", " ", "next", " ", "neighbor", " ", "with", " ", "periodic", " ",
          "boundaries"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"j", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "==", 
             RowBox[{"Length", "[", "lattice", "]"}]}], ",", "1", ",", 
            RowBox[{"i", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Only", " ", "add", " ", "interaction", " ", "if", " ", "both", " ",
            "sites", " ", "are", " ", "occupied"}], "*)"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"lattice", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "!=", "0"}], "&&", 
            RowBox[{
             RowBox[{"lattice", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "!=", "0"}]}], ",", 
           RowBox[{"E", "-=", 
            RowBox[{"JMatrix", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"lattice", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
               RowBox[{
                RowBox[{"lattice", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
             "]"}]}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "lattice", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "E"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"CONFIGURATION", " ", "GENERATION"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Generates", " ", "all", " ", "possible", " ", "configurations", " ", 
      "of", " ", "n", " ", "distinguishable", " ", "particles", " ", "on", " ",
       "L", " ", "sites", " ", "For", " ", "L"}], "=", "4"}], ",", 
    RowBox[{"n", "=", 
     RowBox[{"2", ":", 
      RowBox[{"produces", " ", "12", " ", "configurations", " ", 
       RowBox[{"(", 
        RowBox[{"6", " ", "positions", "\[Times]", "2", " ", "permutations"}],
         ")"}], " ", "Example"}], ":", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "}"}], ",", 
    RowBox[{"etc", "."}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateAllConfigs", "[", 
    RowBox[{"L_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lat", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", "L"}], "]"}]}], "}"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Place", " ", "particles", " ", "at", " ", "selected", " ", 
           "positions", " ", "with", " ", "given", " ", "permutation"}], 
          "*)"}], 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lat", "[", 
              RowBox[{"[", 
               RowBox[{"pos", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{"perm", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "lat"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pos", ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{
           RowBox[{"Range", "[", "L", "]"}], ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "All", " ", "ways", " ", "to", " ", "choose", " ", "n", " ", 
         "positions"}], "*)"}], 
       RowBox[{"{", 
        RowBox[{"perm", ",", 
         RowBox[{"Permutations", "[", 
          RowBox[{"Range", "[", "n", "]"}], "]"}]}], "}"}]}], "      ", 
      RowBox[{"(*", 
       RowBox[{
       "All", " ", "orderings", " ", "of", " ", "n", " ", "particles"}], 
       "*)"}], "]"}], ",", "1"}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"states", "=", 
   RowBox[{"GenerateAllConfigs", "[", 
    RowBox[{"L", ",", "nParticles"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Total configurations: \>\"", ",", 
    RowBox[{"Length", "[", "states", "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<First few: \>\"", ",", 
     RowBox[{"Take", "[", 
      RowBox[{"states", ",", 
       RowBox[{"Min", "[", 
        RowBox[{"5", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "]"}]}], "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"BINARY", " ", "TREE", " ", "RANDOMNESS", " ", "INFRASTRUCTURE"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Global", " ", "variables", " ", "for", " ", "tracking", " ", "position", " ",
     "in", " ", "bit", " ", "sequence", " ", 
    RowBox[{"$BinaryChoices", ":", 
     RowBox[{
     "the", " ", "current", " ", "sequence", " ", "of", " ", "bits", " ", 
      "being", " ", "processed", " ", "$BinaryIndex"}], ":", 
     RowBox[{"current", " ", "read", " ", "position", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "indexed"}], ")"}]}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"$BinaryChoices", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$BinaryIndex", "=", "1"}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Reads", " ", "one", " ", "bit", " ", "from", " ", "the", " ", "current", 
     " ", "bit", " ", "sequence", " ", "and", " ", "advances", " ", "the", " ",
      "position", " ", "This", " ", "simulates", " ", "reading", " ", "a", " ",
      "random", " ", "bit"}], ",", 
    RowBox[{
    "but", " ", "deterministically", " ", "from", " ", "a", " ", "fixed", " ",
      "sequence"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BinaryBit", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"$BinaryChoices", "[", 
        RowBox[{"[", "$BinaryIndex", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"$BinaryIndex", "++"}], ";", "\[IndentingNewLine]", "b"}]}], 
    "]"}]}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Reads", " ", "nBits", " ", "from", " ", "the", " ", "sequence", " ", 
     "and", " ", "interprets", " ", "as", " ", "a", " ", "binary", " ", 
     "integer", " ", 
     RowBox[{"Example", ":", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}], " ", "with", " ", 
       "nBits"}]}]}], "=", 
    RowBox[{
     RowBox[{"3", "\[RightArrow]", 
      RowBox[{
       RowBox[{"0", "\[Times]", "4"}], "+", 
       RowBox[{"1", "\[Times]", "2"}], "+", 
       RowBox[{"1", "\[Times]", "1"}]}]}], "=", "3"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecodeInteger", "[", "nBits_", "]"}], ":=", 
   RowBox[{"FromDigits", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"BinaryBit", "[", "]"}], ",", 
       RowBox[{"{", "nBits", "}"}]}], "]"}], ",", "2"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"KAWASAKI", " ", "MOVE"}], "-", 
    RowBox[{"MAIN", " ", "DYNAMICS", " ", "FUNCTION"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"TWO", "-", 
    RowBox[{"SITE", " ", "KAWASAKI", " ", "MOVE"}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Selects", " ", "TWO", " ", "random", " ", "lattice", " ", "sites", " ", 
     RowBox[{"(", 
      RowBox[{"instead", " ", "of", " ", "adjacent", " ", "neighbors"}], 
      ")"}], " ", "and", " ", "attempts", " ", "to", " ", "swap", " ", "the", 
     " ", "particles", " ", "at", " ", "those", " ", "positions", " ", "Bit", 
     " ", 
     RowBox[{"consumption", ":", 
      RowBox[{
       RowBox[{"-", "First"}], " ", "nBits"}], ":", 
      RowBox[{
       RowBox[{"select", " ", "site", " ", "i"}], "-", 
       RowBox[{"Second", " ", 
        RowBox[{"nBits", ":", 
         RowBox[{
          RowBox[{"select", " ", "site", " ", "j"}], "-", "Total"}], ":", 
         RowBox[{
          RowBox[{
          "2", "\[Times]", "nBits", " ", "bits", " ", "consumed", " ", "This",
            " ", "creates", " ", "longer"}], "-", 
          RowBox[{
          "range", " ", "moves", " ", "compared", " ", "to", " ", "nearest"}],
           "-", 
          RowBox[{"neighbor", " ", "Kawasaki", " ", "Special", " ", 
           RowBox[{"cases", ":", 
            RowBox[{
             RowBox[{"-", "If"}], " ", "i"}]}]}]}]}]}]}]}]}], "=", 
    RowBox[{
     RowBox[{"j", ":", 
      RowBox[{"no", "-", 
       RowBox[{"swap", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"can", "'"}], "t", " ", "swap", " ", "site", " ", "with", " ",
           "itself"}], ")"}]}], "-", 
       RowBox[{"If", " ", 
        RowBox[{"lattice", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}]}], "=", 
     RowBox[{
      RowBox[{"lattice", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ":", 
      RowBox[{"no", "-", 
       RowBox[{"swap", " ", 
        RowBox[{"(", 
         RowBox[{"same", " ", "particle", " ", "type"}], ")"}], " ", 
        "Returns"}]}], ":", 
      RowBox[{
      "Same", " ", "format", " ", "as", " ", "standard", " ", "Kawasaki", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<accept\>\"", ",", "newState", ",", "probability"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<reject\>\"", ",", "oldState", ",", "probability"}], "}"}]\
}], "}"}], " ", "or", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<no-swap\>\"", ",", "state", ",", "probability"}], 
        "}"}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "CORRECTED", " ", "VERSION", " ", "for", " ", "use", " ", "with", " ", 
    "nExtraBits"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KawasakiMoveFromBits", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsize", ",", "nBits", ",", "rawI", ",", "rawJ", ",", "i", ",", "j", ",",
        "new", ",", "\[CapitalDelta]E", ",", "p", ",", "siteProb"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Lsize", "=", 
       RowBox[{"Length", "[", "lattice", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"nBits", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Log2", "[", "Lsize", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"DON", "'"}], "T", " ", "consume", " ", "extra", " ", "bits",
          " ", "here"}], "-", 
        RowBox[{
         RowBox[{"they", "'"}], "re", " ", "already", " ", "accounted", " ", 
         RowBox[{"for", "!"}], " ", "The", " ", "\"\<extra\>\"", " ", "bits", 
         " ", "ARE", " ", "the", " ", "second", " ", "site", " ", "selection",
          " ", "bits"}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"REMOVED", ":", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nExtraBits", ">", "0"}], ",", 
           RowBox[{"DecodeInteger", "[", "nExtraBits", "]"}]}], "]"}]}], 
        ";"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"For", " ", "L"}], "=", 
         RowBox[{
          RowBox[{"4", " ", "with", " ", "nExtraBits"}], "=", 
          RowBox[{
           RowBox[{"2", ":", 
            RowBox[{"-", "nBits"}]}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"first", " ", "site"}], ")"}]}], "-", "nExtraBits"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"second", " ", "site"}], ")"}]}], "-", "Total"}], "=", 
             RowBox[{"4", " ", "bits"}]}]}]}]}]}], ",", 
        RowBox[{"siteProb", "=", 
         RowBox[{"1", "/", "16"}]}]}], "*)"}], 
      RowBox[{"siteProb", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"nBits", "+", "nExtraBits"}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"FIRST", " ", 
        RowBox[{"SITE", ":", 
         RowBox[{"Read", " ", "nBits"}]}]}], "*)"}], 
      RowBox[{"rawI", "=", 
       RowBox[{"DecodeInteger", "[", "nBits", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", 
       RowBox[{"1", "+", 
        RowBox[{"Mod", "[", 
         RowBox[{"rawI", ",", "Lsize"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"SECOND", " ", 
        RowBox[{"SITE", ":", 
         RowBox[{"Read", " ", "nExtraBits", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "which", " ", "equals", " ", "nBits", " ", "for", " ", "L"}], "=",
             "4"}], ")"}]}]}]}], "*)"}], 
      RowBox[{"rawJ", "=", 
       RowBox[{"DecodeInteger", "[", "nExtraBits", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"j", "=", 
       RowBox[{"1", "+", 
        RowBox[{"Mod", "[", 
         RowBox[{"rawJ", ",", "Lsize"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"NO", "-", 
        RowBox[{"SWAP", " ", "CHECKS"}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "==", "j"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<no-swap\>\"", ",", "lattice", ",", "siteProb"}], "}"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"lattice", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "==", 
         RowBox[{"lattice", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<no-swap\>\"", ",", "lattice", ",", "siteProb"}], "}"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"PERFORM", " ", "SWAP"}], "*)"}], 
      RowBox[{"new", "=", "lattice"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"new", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], "]"}], "]"}], "=", 
       RowBox[{"lattice", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"ENERGY", " ", "CHANGE"}], "*)"}], 
      RowBox[{"\[CapitalDelta]E", "=", 
       RowBox[{
        RowBox[{"SymbolicEnergy", "[", "new", "]"}], "-", 
        RowBox[{"SymbolicEnergy", "[", "lattice", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"METROPOLIS", " ", "ACCEPTANCE"}], "*)"}], 
      RowBox[{"p", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"\[CapitalDelta]E", "<=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Beta]"}], " ", "\[CapitalDelta]E"}], "]"}], ",", 
            RowBox[{"\[CapitalDelta]E", ">", "0"}]}], "}"}]}], "}"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<accept\>\"", ",", "new", ",", 
          RowBox[{"siteProb", "*", "p"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<reject\>\"", ",", "lattice", ",", 
          RowBox[{"siteProb", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p"}], ")"}]}]}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CURRENT", " ", "VERSION"}], "-", 
    RowBox[{
    "Standard", " ", "Kawasaki", " ", "Dynamics", " ", "with", " ", 
     "Metropolis", " ", "Acceptance"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "function", " ", "implements", " ", "a", " ", "single", " ", 
    "Monte", " ", "Carlo", " ", 
    RowBox[{"move", ":", 
     RowBox[{
     "1.", " ", "Uses", " ", "random", " ", "bits", " ", "to", " ", "select", 
      " ", "a", " ", "lattice", " ", "site", " ", "2.", " ", "Attempts", " ", 
      "to", " ", "swap", " ", "particles", " ", "with", " ", "the", " ", 
      "next", " ", "neighbor", " ", "3.", " ", 
      RowBox[{"Accepts", "/", "rejects"}], " ", "based", " ", "on", " ", 
      "Metropolis", " ", "criterion", " ", "Returns"}], ":", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "outcomes", " ", "with", " ", "their", " ", 
       "probabilities"}], "-", 
      RowBox[{"If", " ", "sites", " ", "have", " ", "same", " ", "particle", " ", 
       RowBox[{"type", ":", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<no-swap\>\"", ",", "lattice", ",", "probability"}], 
           "}"}], "}"}], "-", "Otherwise"}], ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<accept\>\"", ",", "newState", ",", "acceptProb"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<reject\>\"", ",", "oldState", ",", "rejectProb"}], 
           "}"}]}], "}"}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KawasakiMoveFromBitsDB", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsize", ",", "nBits", ",", "raw", ",", "i", ",", "j", ",", "new", ",", 
       "\[CapitalDelta]E", ",", "p", ",", "siteProb"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Lsize", "=", 
       RowBox[{"Length", "[", "lattice", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"Calculate", " ", "bits", " ", 
        RowBox[{"needed", ":", 
         RowBox[{
          RowBox[{"nBits", " ", "for", " ", "site", " ", "selection"}], "+", 
          RowBox[{"nExtraBits", " ", "for", " ", "enhancements"}]}]}]}], 
       "*)"}], 
      RowBox[{"nBits", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Log2", "[", "Lsize", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"translated", "=", 
       RowBox[{"RotateRight", "[", 
        RowBox[{"lattice", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"e", ".", "g", "."}], ",", 
        RowBox[{"L", "=", 
         RowBox[{"4", " ", "needs", " ", "2", " ", "bits"}]}], ",", 
        RowBox[{"L", "=", 
         RowBox[{"8", " ", "needs", " ", "3", " ", "bits"}]}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CONSUME", " ", "EXTRA", " ", "BITS", " ", 
           RowBox[{"(", 
            RowBox[{"if", " ", "any"}], ")"}]}], "-", 
          RowBox[{"for", " ", "enhanced", " ", "moves", " ", "like", " ", 
           RowBox[{"reversal", "/", "translation"}], " ", "Currently", " ", 
           "nExtraBits"}]}], "=", "0"}], ",", 
        RowBox[{
         RowBox[{
         "so", " ", "this", " ", "does", " ", "nothing", " ", "With", " ", 
          "nExtraBits"}], "=", "1"}], ",", 
        RowBox[{
        "would", " ", "read", " ", "one", " ", "bit", " ", "here", " ", "for",
          " ", "a", " ", "binary", " ", "decision"}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nExtraBits", ">", "0"}], ",", 
        RowBox[{"DecodeInteger", "[", "nExtraBits", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Probability", " ", "weight", " ", "for", " ", "this", " ", "branch",
           " ", "of", " ", "the", " ", "decision", " ", "tree", " ", "With", " ",
           "nBits"}], "=", "2"}], ",", 
        RowBox[{"nExtraBits", "=", 
         RowBox[{
          RowBox[{"0", ":", "siteProb"}], "=", 
          RowBox[{
           RowBox[{"1", "/", "4"}], " ", 
           RowBox[{"(", 
            RowBox[{
            "one", " ", "of", " ", "4", " ", "possible", " ", "bit", " ", 
             "patterns"}], ")"}]}]}]}]}], "*)"}], 
      RowBox[{"siteProb", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"nBits", "+", "nExtraBits"}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"SITE", " ", 
        RowBox[{"SELECTION", ":", 
         RowBox[{
         "Read", " ", "nBits", " ", "to", " ", "choose", " ", "which", " ", 
          "site", " ", "to", " ", "attempt", " ", "swap", " ", "at"}]}]}], 
       "*)"}], 
      RowBox[{"raw", "=", 
       RowBox[{"DecodeInteger", "[", "nBits", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Consumes", " ", "nBits", " ", "from", " ", "$BinaryChoices"}],
        "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Map", " ", "bit", " ", "pattern", " ", "to", " ", "lattice", " ", 
          "site", " ", "with", " ", "modulo", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"handles", " ", 
             RowBox[{"2", "^", "nBits"}]}], ">", "Lsize"}], ")"}], " ", 
          RowBox[{"Example", ":", "raw"}]}], "=", "3"}], ",", 
        RowBox[{"Lsize", "=", 
         RowBox[{
          RowBox[{"4", "\[RightArrow]", "i"}], "=", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"Mod", "[", 
             RowBox[{"3", ",", "4"}], "]"}]}], "=", "4"}]}]}]}], "*)"}], 
      RowBox[{"i", "=", 
       RowBox[{"1", "+", 
        RowBox[{"Mod", "[", 
         RowBox[{"raw", ",", "Lsize"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Next", " ", "site", " ", 
        RowBox[{"(", 
         RowBox[{"periodic", " ", 
          RowBox[{"boundaries", ":", 
           RowBox[{
           "site", " ", "4", " ", "connects", " ", "back", " ", "to", " ", 
            "site", " ", "1"}]}]}], ")"}]}], "*)"}], 
      RowBox[{"j", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "==", "Lsize"}], ",", "1", ",", 
         RowBox[{"i", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"NO", "-", 
         RowBox[{"SWAP", " ", 
          RowBox[{"CHECK", ":", 
           RowBox[{
           "If", " ", "both", " ", "sites", " ", "have", " ", "same", " ", 
            "particle", " ", "type"}]}]}]}], ",", 
        RowBox[{"nothing", " ", "can", " ", "happen", " ", "This", " ", 
         RowBox[{"includes", ":", 
          RowBox[{"both", " ", "empty", " ", 
           RowBox[{"(", 
            RowBox[{"0", ",", "0"}], ")"}]}]}]}], ",", 
        RowBox[{"or", " ", "same", " ", "particle", " ", 
         RowBox[{"(", 
          RowBox[{"1", ",", "1"}], ")"}]}], ",", 
        RowBox[{"(", 
         RowBox[{"2", ",", "2"}], ")"}], ",", 
        RowBox[{"etc", "."}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"translated", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "==", 
         RowBox[{"translated", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<no-swap\>\"", ",", "lattice", ",", "siteProb"}], "}"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"PERFORM", " ", 
        RowBox[{"SWAP", ":", 
         RowBox[{
         "Exchange", " ", "particles", " ", "at", " ", "positions", " ", "i", 
          " ", "and", " ", "j"}]}]}], "*)"}], 
      RowBox[{"new", "=", "translated"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"new", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], "]"}], "]"}], "=", 
       RowBox[{"translated", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ENERGY", " ", 
         RowBox[{"CHANGE", ":", 
          RowBox[{"Calculate", " ", "\[CapitalDelta]E"}]}]}], "=", 
        RowBox[{"E_new", "-", "E_old"}]}], "*)"}], 
      RowBox[{"\[CapitalDelta]E", "=", 
       RowBox[{
        RowBox[{"SymbolicEnergy", "[", "new", "]"}], "-", 
        RowBox[{"SymbolicEnergy", "[", "translated", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"METROPOLIS", " ", "ACCEPTANCE", " ", 
        RowBox[{"PROBABILITY", ":", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "If"}], " ", "\[CapitalDelta]E"}], "\[LessEqual]", 
          RowBox[{"0", " ", 
           RowBox[{"(", 
            RowBox[{
            "energy", " ", "decreases", " ", "or", " ", "stays", " ", 
             "same"}], ")"}]}]}], ":", 
         RowBox[{
          RowBox[{
           RowBox[{"always", " ", "accept", " ", 
            RowBox[{"(", 
             RowBox[{"p", "=", "1"}], ")"}]}], "-", 
           RowBox[{"If", " ", "\[CapitalDelta]E"}]}], ">", 
          RowBox[{"0", " ", 
           RowBox[{"(", 
            RowBox[{"energy", " ", "increases"}], ")"}]}]}], ":", 
         RowBox[{"accept", " ", "with", " ", "probability", " ", "exp", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], "\[Times]", "\[CapitalDelta]E"}], 
           ")"}]}]}]}], "*)"}], 
      RowBox[{"p", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"\[CapitalDelta]E", "<=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Beta]"}], " ", "\[CapitalDelta]E"}], "]"}], ",", 
            RowBox[{"\[CapitalDelta]E", ">", "0"}]}], "}"}]}], "}"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"RETURN", " ", "TWO", " ", "POSSIBLE", " ", 
        RowBox[{"OUTCOMES", ":", 
         RowBox[{"1.", " ", "\"\<accept\>\""}], ":", 
         RowBox[{
         "move", " ", "to", " ", "new", " ", "state", " ", "with", " ", 
          "probability", " ", "siteProb", "\[Times]", "p", " ", "2.", 
          " ", "\"\<reject\>\""}], ":", 
         RowBox[{
         "stay", " ", "in", " ", "old", " ", "state", " ", "with", " ", 
          "probability", " ", "siteProb", "\[Times]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "p"}], ")"}], " ", "These", " ", "probabilities",
           " ", "sum", " ", "to", " ", "siteProb", " ", 
          RowBox[{"(", 
           RowBox[{
           "the", " ", "weight", " ", "of", " ", "this", " ", "branch"}], 
           ")"}]}]}]}], "*)"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<accept\>\"", ",", "new", ",", 
          RowBox[{"siteProb", "*", "p"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<reject\>\"", ",", "translated", ",", 
          RowBox[{"siteProb", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p"}], ")"}]}]}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KawasakiMoveFromBitsnoDB", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsize", ",", "nBits", ",", "raw", ",", "i", ",", "j", ",", "new", ",", 
       "\[CapitalDelta]E", ",", "p", ",", "siteProb"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Lsize", "=", 
       RowBox[{"Length", "[", "lattice", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"Calculate", " ", "bits", " ", 
        RowBox[{"needed", ":", 
         RowBox[{
          RowBox[{"nBits", " ", "for", " ", "site", " ", "selection"}], "+", 
          RowBox[{"nExtraBits", " ", "for", " ", "enhancements"}]}]}]}], 
       "*)"}], 
      RowBox[{"nBits", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Log2", "[", "Lsize", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"translated", "=", 
       RowBox[{"RotateRight", "[", 
        RowBox[{"lattice", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"e", ".", "g", "."}], ",", 
        RowBox[{"L", "=", 
         RowBox[{"4", " ", "needs", " ", "2", " ", "bits"}]}], ",", 
        RowBox[{"L", "=", 
         RowBox[{"8", " ", "needs", " ", "3", " ", "bits"}]}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CONSUME", " ", "EXTRA", " ", "BITS", " ", 
           RowBox[{"(", 
            RowBox[{"if", " ", "any"}], ")"}]}], "-", 
          RowBox[{"for", " ", "enhanced", " ", "moves", " ", "like", " ", 
           RowBox[{"reversal", "/", "translation"}], " ", "Currently", " ", 
           "nExtraBits"}]}], "=", "0"}], ",", 
        RowBox[{
         RowBox[{
         "so", " ", "this", " ", "does", " ", "nothing", " ", "With", " ", 
          "nExtraBits"}], "=", "1"}], ",", 
        RowBox[{
        "would", " ", "read", " ", "one", " ", "bit", " ", "here", " ", "for",
          " ", "a", " ", "binary", " ", "decision"}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nExtraBits", ">", "0"}], ",", 
        RowBox[{"DecodeInteger", "[", "nExtraBits", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Probability", " ", "weight", " ", "for", " ", "this", " ", "branch",
           " ", "of", " ", "the", " ", "decision", " ", "tree", " ", "With", " ",
           "nBits"}], "=", "2"}], ",", 
        RowBox[{"nExtraBits", "=", 
         RowBox[{
          RowBox[{"0", ":", "siteProb"}], "=", 
          RowBox[{
           RowBox[{"1", "/", "4"}], " ", 
           RowBox[{"(", 
            RowBox[{
            "one", " ", "of", " ", "4", " ", "possible", " ", "bit", " ", 
             "patterns"}], ")"}]}]}]}]}], "*)"}], 
      RowBox[{"siteProb", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"nBits", "+", "nExtraBits"}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"SITE", " ", 
        RowBox[{"SELECTION", ":", 
         RowBox[{
         "Read", " ", "nBits", " ", "to", " ", "choose", " ", "which", " ", 
          "site", " ", "to", " ", "attempt", " ", "swap", " ", "at"}]}]}], 
       "*)"}], 
      RowBox[{"raw", "=", 
       RowBox[{"DecodeInteger", "[", "nBits", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Consumes", " ", "nBits", " ", "from", " ", "$BinaryChoices"}],
        "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Map", " ", "bit", " ", "pattern", " ", "to", " ", "lattice", " ", 
          "site", " ", "with", " ", "modulo", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"handles", " ", 
             RowBox[{"2", "^", "nBits"}]}], ">", "Lsize"}], ")"}], " ", 
          RowBox[{"Example", ":", "raw"}]}], "=", "3"}], ",", 
        RowBox[{"Lsize", "=", 
         RowBox[{
          RowBox[{"4", "\[RightArrow]", "i"}], "=", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"Mod", "[", 
             RowBox[{"3", ",", "4"}], "]"}]}], "=", "4"}]}]}]}], "*)"}], 
      RowBox[{"i", "=", 
       RowBox[{"1", "+", 
        RowBox[{"Mod", "[", 
         RowBox[{"raw", ",", "Lsize"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Next", " ", "site", " ", 
        RowBox[{"(", 
         RowBox[{"periodic", " ", 
          RowBox[{"boundaries", ":", 
           RowBox[{
           "site", " ", "4", " ", "connects", " ", "back", " ", "to", " ", 
            "site", " ", "1"}]}]}], ")"}]}], "*)"}], 
      RowBox[{"j", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "==", "Lsize"}], ",", "1", ",", 
         RowBox[{"i", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"NO", "-", 
         RowBox[{"SWAP", " ", 
          RowBox[{"CHECK", ":", 
           RowBox[{
           "If", " ", "both", " ", "sites", " ", "have", " ", "same", " ", 
            "particle", " ", "type"}]}]}]}], ",", 
        RowBox[{"nothing", " ", "can", " ", "happen", " ", "This", " ", 
         RowBox[{"includes", ":", 
          RowBox[{"both", " ", "empty", " ", 
           RowBox[{"(", 
            RowBox[{"0", ",", "0"}], ")"}]}]}]}], ",", 
        RowBox[{"or", " ", "same", " ", "particle", " ", 
         RowBox[{"(", 
          RowBox[{"1", ",", "1"}], ")"}]}], ",", 
        RowBox[{"(", 
         RowBox[{"2", ",", "2"}], ")"}], ",", 
        RowBox[{"etc", "."}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"translated", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "==", 
         RowBox[{"translated", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<no-swap\>\"", ",", "lattice", ",", "siteProb"}], "}"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"PERFORM", " ", 
        RowBox[{"SWAP", ":", 
         RowBox[{
         "Exchange", " ", "particles", " ", "at", " ", "positions", " ", "i", 
          " ", "and", " ", "j"}]}]}], "*)"}], 
      RowBox[{"new", "=", "translated"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"new", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], "]"}], "]"}], "=", 
       RowBox[{"translated", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ENERGY", " ", 
         RowBox[{"CHANGE", ":", 
          RowBox[{"Calculate", " ", "\[CapitalDelta]E"}]}]}], "=", 
        RowBox[{"E_new", "-", "E_old"}]}], "*)"}], 
      RowBox[{"\[CapitalDelta]E", "=", 
       RowBox[{
        RowBox[{"SymbolicEnergy", "[", "new", "]"}], "-", 
        RowBox[{"SymbolicEnergy", "[", "translated", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"METROPOLIS", " ", "ACCEPTANCE", " ", 
        RowBox[{"PROBABILITY", ":", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "If"}], " ", "\[CapitalDelta]E"}], "\[LessEqual]", 
          RowBox[{"0", " ", 
           RowBox[{"(", 
            RowBox[{
            "energy", " ", "decreases", " ", "or", " ", "stays", " ", 
             "same"}], ")"}]}]}], ":", 
         RowBox[{
          RowBox[{
           RowBox[{"always", " ", "accept", " ", 
            RowBox[{"(", 
             RowBox[{"p", "=", "1"}], ")"}]}], "-", 
           RowBox[{"If", " ", "\[CapitalDelta]E"}]}], ">", 
          RowBox[{"0", " ", 
           RowBox[{"(", 
            RowBox[{"energy", " ", "increases"}], ")"}]}]}], ":", 
         RowBox[{"accept", " ", "with", " ", "probability", " ", "exp", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], "\[Times]", "\[CapitalDelta]E"}], 
           ")"}]}]}]}], "*)"}], 
      RowBox[{"p", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"\[CapitalDelta]E", "<=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Beta]"}], " ", "\[CapitalDelta]E"}], "]"}], ",", 
            RowBox[{"\[CapitalDelta]E", ">", "0"}]}], "}"}]}], "}"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"RETURN", " ", "TWO", " ", "POSSIBLE", " ", 
        RowBox[{"OUTCOMES", ":", 
         RowBox[{"1.", " ", "\"\<accept\>\""}], ":", 
         RowBox[{
         "move", " ", "to", " ", "new", " ", "state", " ", "with", " ", 
          "probability", " ", "siteProb", "\[Times]", "p", " ", "2.", 
          " ", "\"\<reject\>\""}], ":", 
         RowBox[{
         "stay", " ", "in", " ", "old", " ", "state", " ", "with", " ", 
          "probability", " ", "siteProb", "\[Times]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "p"}], ")"}], " ", "These", " ", "probabilities",
           " ", "sum", " ", "to", " ", "siteProb", " ", 
          RowBox[{"(", 
           RowBox[{
           "the", " ", "weight", " ", "of", " ", "this", " ", "branch"}], 
           ")"}]}]}]}], "*)"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<accept\>\"", ",", "new", ",", 
          RowBox[{"siteProb", "*", "p"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<reject\>\"", ",", "translated", ",", 
          RowBox[{"siteProb", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p"}], ")"}]}]}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DECISION", " ", "TREE", " ", "ENUMERATION"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Enumerates", " ", "ALL", " ", "possible", " ", "outcomes", " ", "from", 
      " ", "a", " ", "given", " ", "lattice", " ", "state", " ", "For", " ", 
      "L"}], "=", "4"}], ",", 
    RowBox[{"nExtraBits", "=", 
     RowBox[{
      RowBox[{"0", ":", 
       RowBox[{"explores", " ", 
        RowBox[{"2", "^", "2"}]}]}], "=", 
      RowBox[{
      "4", " ", "possible", " ", "bit", " ", "sequences", " ", "Each", " ", 
       "bit", " ", "sequence", " ", "determines", " ", "which", " ", "site", " ",
        "is", " ", "selected", " ", "for", " ", "swap", " ", 
       RowBox[{"Returns", ":", 
        RowBox[{
        "List", " ", "of", " ", "all", " ", "possible", " ", "outcomes", " ", 
         "with", " ", "format"}], ":", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "bitSequence", ",", "outcomeType", ",", "finalState", ",", 
             "probability"}], "}"}], ",", "..."}], "}"}], " ", "Example", " ", 
         RowBox[{"entry", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<accept\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"1", "/", "4"}], "\[Times]", "exp", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "\[Beta]"}], "\[Times]", "\[CapitalDelta]E"}], 
              ")"}]}]}], "}"}]}]}]}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EnumerateTree", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nBitsForSite", ",", "nBitsTotal", ",", "allBits", ",", "results"}], 
      "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{"Calculate", " ", "total", " ", "bits", " ", "needed"}], "*)"}], 
     RowBox[{
      RowBox[{"nBitsForSite", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Log2", "[", 
         RowBox[{"Length", "[", "lattice", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nBitsTotal", "=", 
       RowBox[{"nBitsForSite", "+", "nExtraBits"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "GENERATE", " ", "ALL", " ", "POSSIBLE", " ", "BIT", " ", "SEQUENCES",
          " ", "For", " ", "nBitsTotal"}], "=", 
        RowBox[{"2", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], "*)"}], 
      RowBox[{"allBits", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "nBitsTotal"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"FOR", " ", "EACH", " ", "BIT", " ", "SEQUENCE"}], ",", 
        RowBox[{
        "call", " ", "KawasakiMoveFromBits", " ", "and", " ", "record", " ", 
         "outcome"}]}], "*)"}], 
      RowBox[{"results", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"(*", 
           RowBox[{
           "Set", " ", "up", " ", "the", " ", "bit", " ", "sequence", " ", 
            "for", " ", "this", " ", "iteration"}], "*)"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"$BinaryChoices", "=", "bits"}], ";", 
             RowBox[{"(*", 
              RowBox[{
              "Set", " ", "the", " ", "bits", " ", "to", " ", "be", " ", 
               "read"}], "*)"}], 
             RowBox[{"$BinaryIndex", "=", "1"}], ";", 
             RowBox[{"(*", 
              RowBox[{
              "Reset", " ", "read", " ", "position", " ", "to", " ", 
               "start"}], "*)"}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Call", " ", "the", " ", "move", " ", "function"}], "-", 
               RowBox[{
               "it", " ", "will", " ", "consume", " ", "bits", " ", "from", " ",
                 "$BinaryChoices"}]}], "*)"}], 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"out", "=", 
                 RowBox[{"TESTFUNCTION", "[", "lattice", "]"}]}], "}"}], ",", 
               
               RowBox[{"(*", 
                RowBox[{
                "UNPACK", " ", "RESULT", " ", "based", " ", "on", " ", 
                 "outcome", " ", "type"}], "*)"}], 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "[", "out", "]"}], 
                  "===", "\"\<no-swap\>\""}], ",", 
                 RowBox[{"(*", 
                  RowBox[{"No", "-", 
                   RowBox[{"swap", " ", 
                    RowBox[{"case", ":", 
                    RowBox[{"single", " ", "outcome"}]}]}]}], "*)"}], 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"bits", ",", "\"\<no-swap\>\"", ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "}"}], ",", 
                 RowBox[{"(*", 
                  RowBox[{"Swap", " ", 
                   RowBox[{"case", ":", 
                    RowBox[{"two", " ", "outcomes", " ", 
                    RowBox[{"(", 
                    RowBox[{"accept", " ", "and", " ", "reject"}], 
                    ")"}]}]}]}], "*)"}], 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"bits", ",", "\"\<accept\>\"", ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"bits", ",", "\"\<reject\>\"", ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}],
                 "]"}]}], "]"}]}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"bits", ",", "allBits"}], "}"}]}], "  ", 
          RowBox[{"(*", 
           RowBox[{
           "Iterate", " ", "over", " ", "all", " ", "bit", " ", "sequences"}],
            "*)"}], "]"}], ",", "1"}], "  ", 
        RowBox[{"(*", 
         RowBox[{
         "Flatten", " ", "by", " ", "one", " ", "level", " ", "to", " ", 
          "get", " ", "flat", " ", "list"}], "*)"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "results"}]}], "]"}]}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"TREE", " ", "VISUALIZATION"}], "-", 
    RowBox[{"GRAPHICAL", " ", "DISPLAY"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Creates", " ", "a", " ", "scrollable", " ", "visualization", " ", "of", 
      " ", "the", " ", "decision", " ", "tree", " ", "Shows", " ", "all", " ",
       "possible", " ", "bit", " ", "sequences", " ", "as", " ", "paths", " ",
       "from", " ", "root", " ", "to", " ", "leaves", " ", "Color", " ", 
      RowBox[{"coding", ":", "Blue"}]}], "=", 
     RowBox[{"0", " ", "bit"}]}], ",", 
    RowBox[{"Red", "=", 
     RowBox[{"1", " ", "bit", " ", "Leaves", " ", 
      RowBox[{"show", ":", 
       RowBox[{"final", " ", "state"}]}]}]}], ",", 
    RowBox[{"outcome", " ", "type", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"accept", "/", "reject"}], "/", "no"}], "-", "swap"}], 
      ")"}]}], ",", "probability"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualizeDecisionTree", "[", "initialState_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tree", ",", "nBitsForSite", ",", "nBitsTotal", ",", "yLevels", ",", 
       "xSpacing", ",", "nodeRadius", ",", "rootX", ",", "rootY", ",", 
       "pathGraphics", ",", "baseXPositions", ",", "imageWidth", ",", 
       "plotRangeX", ",", "Lsize", ",", "rootGraphics"}], "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{"Generate", " ", "the", " ", "decision", " ", "tree"}], "*)"}], 
     
     RowBox[{
      RowBox[{"tree", "=", 
       RowBox[{"EnumerateTree", "[", "initialState", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Lsize", "=", 
       RowBox[{"Length", "[", "initialState", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nBitsForSite", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Log2", "[", "Lsize", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nBitsTotal", "=", 
       RowBox[{"nBitsForSite", "+", "nExtraBits"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Layout", " ", "parameters"}], "-", 
        RowBox[{"create", " ", "wide", " ", "scrollable", " ", "canvas"}]}], 
       "*)"}], 
      RowBox[{"imageWidth", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"1800", ",", 
         RowBox[{
          RowBox[{"Length", "[", "tree", "]"}], "*", "60"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotRangeX", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"50", ",", 
         RowBox[{
          RowBox[{"Length", "[", "tree", "]"}], "*", "3"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yLevels", "=", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"nBitsTotal", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "]"}], "*", "2"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Vertical", " ", "positions", " ", "for", " ", "each", " ", "bit", " ",
         "level"}], "*)"}], 
      RowBox[{"xSpacing", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"20", ",", 
         RowBox[{
          RowBox[{"Length", "[", "tree", "]"}], "*", "1.5"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodeRadius", "=", "0.2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rootX", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rootY", "=", 
       RowBox[{"yLevels", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Horizontal", " ", "positions", " ", "for", " ", "leaf", " ", "nodes", 
        " ", 
        RowBox[{"(", 
         RowBox[{"spread", " ", "evenly"}], ")"}]}], "*)"}], 
      RowBox[{"baseXPositions", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", "tree", "]"}], "+", "1"}], ")"}], "/", 
             "2"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"xSpacing", "/", "1.5"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "tree", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "GENERATE", " ", "GRAPHICS", " ", "FOR", " ", "EACH", " ", "PATH", " ",
         "through", " ", "the", " ", "tree"}], "*)"}], 
      RowBox[{"pathGraphics", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "path", ",", "pathType", ",", "finalState", ",", "probability", ",",
              "currentX", ",", "currentY", ",", "lineGraphics", ",", 
             "circleGraphics", ",", "labelGraphics", ",", "bit", ",", "level",
              ",", "nextX", ",", "nextY", ",", "edgeColor", ",", "leafY", ",",
              "leafX", ",", "leafColor", ",", "leafText", ",", "treeEntry"}], 
            "}"}], ",", 
           RowBox[{"(*", 
            RowBox[{"Unpack", " ", "tree", " ", "entry"}], "*)"}], 
           RowBox[{
            RowBox[{"treeEntry", "=", 
             RowBox[{"tree", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"path", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"treeEntry", ",", "1"}], "]"}]}], ";", 
            RowBox[{"(*", 
             RowBox[{"Bit", " ", "sequence"}], "*)"}], 
            RowBox[{"pathType", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"treeEntry", ",", "2"}], "]"}]}], ";", 
            RowBox[{"(*", 
             RowBox[{"\"\<accept\>\"", ",", "\"\<reject\>\"", ",", 
              RowBox[{"or", " ", "\"\<no-swap\>\""}]}], "*)"}], 
            RowBox[{"finalState", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"treeEntry", ",", "3"}], "]"}]}], ";", 
            RowBox[{"(*", 
             RowBox[{"Resulting", " ", "lattice", " ", "configuration"}], 
             "*)"}], 
            RowBox[{"probability", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"treeEntry", ",", "4"}], "]"}]}], ";", 
            RowBox[{"(*", 
             RowBox[{"Probability", " ", "of", " ", "this", " ", "outcome"}], 
             "*)"}], 
            RowBox[{"(*", 
             RowBox[{"Start", " ", "at", " ", "root"}], "*)"}], 
            RowBox[{"currentX", "=", "rootX"}], ";", "\[IndentingNewLine]", 
            RowBox[{"currentY", "=", "rootY"}], ";", "\[IndentingNewLine]", 
            RowBox[{"lineGraphics", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"circleGraphics", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"labelGraphics", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"DRAW", " ", 
              RowBox[{"PATH", ":", 
               RowBox[{
               "For", " ", "each", " ", "bit", " ", "in", " ", "the", " ", 
                "sequence"}]}]}], "*)"}], 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"bit", "=", 
                RowBox[{"path", "[", 
                 RowBox[{"[", "level", "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Calculate", " ", "next", " ", "node", " ", "position", " ", 
                 RowBox[{"(", 
                  RowBox[{
                  "converging", " ", "toward", " ", "final", " ", "x", " ", 
                   "position"}], ")"}]}], "*)"}], 
               RowBox[{"nextX", "=", 
                RowBox[{
                 RowBox[{"baseXPositions", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"currentX", "-", 
                    RowBox[{"baseXPositions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", "0.3"}]}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"nextY", "=", 
                RowBox[{"yLevels", "[", 
                 RowBox[{"[", 
                  RowBox[{"level", "+", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Color", " ", 
                  RowBox[{"edges", ":", 
                   RowBox[{"Blue", " ", "for", " ", "0"}]}]}], ",", 
                 RowBox[{"Red", " ", "for", " ", "1"}]}], "*)"}], 
               RowBox[{"edgeColor", "=", 
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"bit", "==", "0"}], ",", "Blue", ",", 
                  RowBox[{"bit", "==", "1"}], ",", "Red", ",", "True", ",", 
                  "Black"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Draw", " ", "edge", " ", "from", " ", "current", " ", "to", " ",
                  "next", " ", "position"}], "*)"}], 
               RowBox[{"AppendTo", "[", 
                RowBox[{"lineGraphics", ",", 
                 RowBox[{"{", 
                  RowBox[{"edgeColor", ",", 
                   RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
                   RowBox[{"Arrowheads", "[", "0", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"currentX", ",", "currentY"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nextX", ",", "nextY"}], "}"}]}], "}"}], "]"}]}], 
                  "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Draw", " ", "node", " ", "circle"}], "*)"}], 
               RowBox[{"AppendTo", "[", 
                RowBox[{"circleGraphics", ",", 
                 RowBox[{"{", 
                  RowBox[{"White", ",", 
                   RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "Thin"}], "}"}], "]"}], ",", 
                   RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"nextX", ",", "nextY"}], "}"}], ",", 
                    "nodeRadius"}], "]"}]}], "}"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Label", " ", "node", " ", "with", " ", "bit", " ", "value"}],
                 "*)"}], 
               RowBox[{"AppendTo", "[", 
                RowBox[{"labelGraphics", ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"bit", ",", "Bold", ",", "12"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"nextX", ",", "nextY"}], "}"}]}], "]"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Move", " ", "to", " ", "next", " ", "position"}], 
                "*)"}], 
               RowBox[{"currentX", "=", "nextX"}], ";", "\[IndentingNewLine]", 
               RowBox[{"currentY", "=", "nextY"}], ";"}], ",", 
              RowBox[{"{", 
               RowBox[{"level", ",", 
                RowBox[{"Length", "[", "path", "]"}]}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "DRAW", " ", "LEAF", " ", "NODE", " ", "at", " ", "bottom"}], 
             "*)"}], 
            RowBox[{"leafY", "=", 
             RowBox[{"-", "3"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"leafX", "=", 
             RowBox[{"baseXPositions", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Format", " ", "leaf", " ", "label", " ", "based", " ", "on", " ",
               "outcome", " ", "type"}], "*)"}], 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"leafColor", ",", "leafText"}], "}"}], "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"pathType", "==", "\"\<no-swap\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"LightGray", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "finalState", "]"}], ",", "Gray",
                     ",", "12"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<no-swap\>\"", ",", "Gray", ",", "10"}], 
                    "]"}]}], "}"}], ",", "Center", ",", 
                   RowBox[{"Spacings", "->", "0.1"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"pathType", "==", "\"\<accept\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"LightYellow", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "finalState", "]"}], ",", 
                    "Black", ",", "Bold", ",", "12"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<accept\>\"", ",", "Black", ",", "10"}], 
                    "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<P=\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"Simplify", "[", "probability", "]"}], "]"}], 
                    "]"}]}], ",", "Black", ",", "10"}], "]"}]}], "}"}], ",", 
                   "Center", ",", 
                   RowBox[{"Spacings", "->", "0.1"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"pathType", "==", "\"\<reject\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"LightYellow", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "finalState", "]"}], ",", 
                    "Black", ",", "Bold", ",", "12"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<reject\>\"", ",", "Black", ",", "10"}], 
                    "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<P=\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"Simplify", "[", "probability", "]"}], "]"}], 
                    "]"}]}], ",", "Black", ",", "10"}], "]"}]}], "}"}], ",", 
                   "Center", ",", 
                   RowBox[{"Spacings", "->", "0.1"}]}], "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Draw", " ", "leaf", " ", "rectangle"}], "*)"}], 
            RowBox[{"AppendTo", "[", 
             RowBox[{"circleGraphics", ",", 
              RowBox[{"{", 
               RowBox[{"leafColor", ",", 
                RowBox[{"EdgeForm", "[", 
                 RowBox[{"{", 
                  RowBox[{"Black", ",", "Thin"}], "}"}], "]"}], ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"leafX", "-", "1.2"}], ",", 
                    RowBox[{"leafY", "-", "0.7"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"leafX", "+", "1.2"}], ",", 
                    RowBox[{"leafY", "+", "0.7"}]}], "}"}]}], "]"}]}], 
               "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Add", " ", "leaf", " ", "label"}], "*)"}], 
            RowBox[{"AppendTo", "[", 
             RowBox[{"labelGraphics", ",", 
              RowBox[{"Text", "[", 
               RowBox[{"leafText", ",", 
                RowBox[{"{", 
                 RowBox[{"leafX", ",", "leafY"}], "}"}]}], "]"}]}], "]"}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Return", " ", "graphics", " ", "for", " ", "this", " ", 
              "path"}], "*)"}], 
            RowBox[{"{", 
             RowBox[{
             "lineGraphics", ",", "circleGraphics", ",", "labelGraphics"}], 
             "}"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "tree", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"DRAW", " ", "ROOT", " ", "NODE"}], "*)"}], 
      RowBox[{"rootGraphics", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LightBlue", ",", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Thick"}], "}"}], "]"}], ",", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rootX", ",", "rootY"}], "}"}], ",", 
             RowBox[{"nodeRadius", "*", "2"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<START\\n\>\"", "<>", 
              RowBox[{"ToString", "[", "initialState", "]"}]}], ",", "Bold", ",",
              "14"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"rootX", ",", "rootY"}], "}"}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "COMBINE", " ", "AND", " ", "WRAP", " ", "in", " ", "scrollable", " ", 
        "pane"}], "*)"}], 
      RowBox[{"Pane", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pathGraphics", ",", "rootGraphics"}], "}"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "plotRangeX"}], ",", "plotRangeX"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "4"}], ",", 
               RowBox[{
                RowBox[{"yLevels", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "2"}]}], "}"}]}], 
            "}"}]}], ",", 
          RowBox[{"AspectRatio", "->", "0.4"}], ",", 
          RowBox[{"Background", "->", "White"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1800", ",", "600"}], "}"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Pane", " ", "size"}], "*)"}], 
        RowBox[{"Scrollbars", "->", "True"}]}], "]"}]}]}], "]"}]}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"TRANSITION", " ", "PROBABILITY", " ", "CALCULATION"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Converts", " ", "decision", " ", "tree", " ", "into", " ", "state"}], "-",
      "to", "-", 
     RowBox[{
     "state", " ", "transition", " ", "probabilities", " ", "Multiple", " ", 
      "bit", " ", "sequences", " ", "can", " ", "lead", " ", "to", " ", 
      "same", " ", "state", " ", "transition", " ", "This", " ", "function", " ",
       "merges", " ", "them", " ", "by", " ", "summing", " ", "their", " ", 
      "probabilities", " ", 
      RowBox[{"Example", ":", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}], "\[RightArrow]", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}], " ", "might", " ",
          "occur", " ", "via"}]}], ":", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "bits"}], " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], " ", "causing", 
         " ", "\"\<no-swap\>\"", " ", 
         RowBox[{"(", 
          RowBox[{"prob", " ", 
           RowBox[{"1", "/", "4"}]}], ")"}]}], "-", 
        RowBox[{"bits", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], " ", "causing", " ", "swap", " ", 
         "with", " ", "rejection", " ", 
         RowBox[{"(", 
          RowBox[{"prob", " ", 
           RowBox[{"1", "/", "4"}], "\[Times]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p"}], ")"}]}], ")"}], " ", "Total", " ", 
         "probability"}]}]}]}]}], "=", 
    RowBox[{
     RowBox[{"1", "/", "4"}], "+", 
     RowBox[{
      RowBox[{"1", "/", "4"}], "\[Times]", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"EnumerateTransitions", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tree", "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "Get", " ", "all", " ", "outcomes", " ", "from", " ", "this", " ", 
       "state"}], "*)"}], 
     RowBox[{
      RowBox[{"tree", "=", 
       RowBox[{"EnumerateTree", "[", "lattice", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Group", " ", "by", " ", 
        RowBox[{"(", 
         RowBox[{"fromState", ",", "toState"}], ")"}], " ", "pair", " ", 
        "and", " ", "sum", " ", "probabilities", " ", "Merge", " ", "with", " ", 
        RowBox[{"Total", ":", 
         RowBox[{
         "combines", " ", "duplicate", " ", "keys", " ", "by", " ", "adding", 
          " ", "values"}]}]}], "*)"}], 
      RowBox[{"Merge", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lattice", ",", 
             RowBox[{"tree", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], "->", 
           RowBox[{"tree", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tree", "]"}]}], "}"}]}], "]"}], ",", 
        "Total"}], "]"}]}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"TRANSITION", " ", "MATRIX", " ", "CONSTRUCTION"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Builds", " ", "the", " ", "complete", " ", "Markov", " ", "chain", " ", 
      "transition", " ", "matrix", " ", "Matrix", " ", "element", " ", 
      RowBox[{"M", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "=", 
     RowBox[{
     "probability", " ", "of", " ", "transitioning", " ", "from", " ", 
      "state", " ", "i", " ", "to", " ", "state", " ", "j", " ", 
      RowBox[{"Process", ":", 
       RowBox[{"1.", " ", "Create", " ", "index", " ", "mapping"}], ":", 
       RowBox[{"states", "\[RightArrow]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}], " ", "2.", " ",
          "For", " ", "each", " ", "state"}]}]}]}]}], ",", 
    RowBox[{
     RowBox[{
     "enumerate", " ", "all", " ", "transitions", " ", "3.", " ", "Fill", " ",
       "in", " ", "matrix", " ", "entries", " ", 
      RowBox[{"Result", ":", 
       RowBox[{
       "n", "\[Times]", "n", " ", "symbolic", " ", "matrix", " ", "where", " ",
         "n"}]}]}], "=", 
     RowBox[{"number", " ", "of", " ", "states"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildTransitionMatrix", "[", "states_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "idx", ",", "M", ",", "trans"}], "}"}], ",", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "states", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Create", " ", 
          RowBox[{"association", ":", 
           RowBox[{"state", "\[RightArrow]", 
            RowBox[{"matrix", " ", "index", " ", "Example"}]}], ":", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}]}]}], "->", 
         "1"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "}"}], "->", "2"}], ",", 
        RowBox[{"etc", "."}]}], "*)"}], 
      RowBox[{"idx", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"states", "->", 
         RowBox[{"Range", "[", "n", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Initialize", " ", "matrix", " ", "with", " ", "zeros"}], 
       "*)"}], 
      RowBox[{"M", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"FOR", " ", "EACH", " ", 
        RowBox[{"STATE", ":", 
         RowBox[{
         "compute", " ", "transitions", " ", "and", " ", "fill", " ", 
          "matrix"}]}]}], "*)"}], 
      RowBox[{"Do", "[", 
       RowBox[{"(*", 
        RowBox[{
        "Get", " ", "all", " ", "transitions", " ", "from", " ", "state", " ",
          "s"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"trans", "=", 
          RowBox[{"EnumerateTransitions", "[", "s", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Fill", " ", 
            RowBox[{"matrix", ":", 
             RowBox[{"M", "[", 
              RowBox[{"from", ",", "to"}], "]"}]}]}], "=", 
           RowBox[{
           "probability", " ", "KeyValueMap", " ", "applies", " ", "function",
             " ", "to", " ", "each", " ", 
            RowBox[{"(", 
             RowBox[{"key", "->", "value"}], ")"}], " ", "pair", " ", "Key", " ", 
            RowBox[{"format", ":", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"fromState", ",", "toState"}], "}"}], " ", "Value"}], ":", 
             RowBox[{"transition", " ", "probability"}]}]}]}], "*)"}], 
         RowBox[{"KeyValueMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"idx", "[", 
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"idx", "[", 
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}], "=",
               "#2"}], ")"}], "&"}], ",", "trans"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "states"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "M"}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"BUILD", " ", "THE", " ", "TRANSITION", " ", "MATRIX"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "where", " ", "the", " ", "heavy", " ", 
      "computation", " ", 
      RowBox[{"happens", "!"}], " ", "For", " ", "L"}], "=", "4"}], ",", 
    RowBox[{"nParticles", "=", 
     RowBox[{"2", ":", 
      RowBox[{"12", " ", "states"}]}]}], ",", 
    RowBox[{
     RowBox[{"12", "\[Times]", "12"}], "=", 
     RowBox[{
      RowBox[{
      "144", " ", "matrix", " ", "entries", " ", "Each", " ", "state", " ", 
       "explores", " ", "4", " ", "bit", " ", "sequences"}], "\[RightArrow]", 
      
      RowBox[{"48", " ", "total", " ", "tree", " ", "evaluations"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transitionMatrix", "=", 
    RowBox[{"BuildTransitionMatrix", "[", "states", "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"VERIFY", ":", 
    RowBox[{"Row", " ", "sums", " ", "should", " ", "equal", " ", "1", " ", 
     RowBox[{"(", 
      RowBox[{"stochastic", " ", "matrix", " ", "property"}], ")"}], " ", 
     "Each", " ", "row", " ", "represents", " ", "all", " ", "transitions", " ",
      "from", " ", "one", " ", "state", " ", "Probabilities", " ", "must", " ",
      "sum", " ", "to", " ", "1"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\\nTransition matrix row sums: \>\"", ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Total", "[", 
       RowBox[{"transitionMatrix", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DISPLAY", ":", 
    RowBox[{"Show", " ", "matrix", " ", 
     RowBox[{"(", 
      RowBox[{"or", " ", "portion", " ", "if", " ", "too", " ", "large"}], 
      ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Transition matrix:\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "states", "]"}], "<=", "20"}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{"transitionMatrix", "//", "MatrixForm"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Showing 5x5 block:\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{"transitionMatrix", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "20"}], "}"}]}], "]"}], "//", "MatrixForm"}], 
       "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DETAILED", " ", "BALANCE", " ", "CHECK"}], "-", 
    RowBox[{"OPTIMIZED", " ", "VERSION"}]}], "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Detailed", " ", "balance", " ", "is", " ", "the", " ", 
      RowBox[{"condition", ":", 
       RowBox[{"\[Pi]", 
        RowBox[{"(", "i", ")"}], "\[Times]", "P", 
        RowBox[{"(", 
         RowBox[{"i", "\[RightArrow]", "j"}], ")"}]}]}]}], "=", 
     RowBox[{"\[Pi]", 
      RowBox[{"(", "j", ")"}], "\[Times]", "P", 
      RowBox[{"(", 
       RowBox[{"j", "\[RightArrow]", "i"}], ")"}], " ", "for", " ", "all", " ",
       "pairs", " ", "of", " ", "states", " ", "i"}]}], ",", 
    RowBox[{
     RowBox[{"j", " ", "Where", " ", "\[Pi]", 
      RowBox[{"(", "i", ")"}], " ", "is", " ", "the", " ", "Boltzmann", " ", 
      RowBox[{"distribution", ":", 
       RowBox[{
        RowBox[{"\[Pi]", 
         RowBox[{"(", "i", ")"}]}], "\[Proportional]", 
        RowBox[{"exp", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], "\[Times]", "E", 
           RowBox[{"(", "i", ")"}]}], ")"}], " ", "This", " ", "ensures", " ",
          "the", " ", "Markov", " ", "chain", " ", "has", " ", "the", " ", 
         "correct", " ", "equilibrium", " ", "distribution", " ", 
         "Strategy"}]}], ":", 
       RowBox[{
       "1.", " ", "Factor", " ", "out", " ", "partition", " ", "function", " ",
         "Z", " ", 
        RowBox[{"(", 
         RowBox[{"cancels", " ", "in", " ", "detailed", " ", "balance"}], 
         ")"}], " ", "2.", " ", "Compute", " ", "violations", " ", "for", " ",
         "all", " ", "state", " ", "pairs", " ", "3.", " ", "Remove", " ", 
        "duplicates", " ", "4.", " ", "Use", " ", "FullSimplify", " ", "to", " ",
         "prove", " ", "violations"}]}]}], "=", "0"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"STEP", " ", "1"}], ":", 
    RowBox[{
    "Compute", " ", "unnormalized", " ", "Boltzmann", " ", "weights", " ", 
     RowBox[{"(", 
      RowBox[{"Z", " ", "cancels", " ", "out"}], ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boltzmannWeights", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "\[Beta]"}], "*", 
        RowBox[{"SymbolicEnergy", "[", 
         RowBox[{"states", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Print", "[", "\"\<Computing detailed balance violations...\>\"", "]"}], 
   ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"STEP", " ", "2"}], ":", 
     RowBox[{
      RowBox[{
      "Compute", " ", "violations", " ", "for", " ", "all", " ", "pairs", " ",
        "i"}], "<", 
      RowBox[{"j", " ", "Violation", 
       RowBox[{"(", 
        RowBox[{"i", ",", "j"}], ")"}]}]}]}], "=", 
    RowBox[{
     RowBox[{"\[Pi]", 
      RowBox[{"(", "i", ")"}], "\[Times]", "P", 
      RowBox[{"(", 
       RowBox[{"i", "\[RightArrow]", "j"}], ")"}]}], "-", 
     RowBox[{"\[Pi]", 
      RowBox[{"(", "j", ")"}], "\[Times]", "P", 
      RowBox[{"(", 
       RowBox[{"j", "\[RightArrow]", "i"}], ")"}], " ", "Should", " ", 
      "equal", " ", "0", " ", "if", " ", "detailed", " ", "balance", " ", 
      "holds"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"violations", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"boltzmannWeights", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"transitionMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"boltzmannWeights", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"transitionMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}], ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Only", " ", "check", " ", "pairs", " ", "i"}], "<", 
        RowBox[{"j", " ", "to", " ", "avoid", " ", "duplicates"}]}], "*)"}], 
      "]"}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"STEP", " ", "3"}], ":", 
    RowBox[{"Remove", " ", "literal", " ", "zeros", " ", 
     RowBox[{"(", 
      RowBox[{
      "expressions", " ", "that", " ", "are", " ", "exactly", " ", "0"}], 
      ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nonZero", "=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"violations", ",", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Non-literal-zero violations: \>\"", ",", 
     RowBox[{"Length", "[", "nonZero", "]"}]}], "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"STEP", " ", "4"}], ":", 
     RowBox[{"Remove", " ", "duplicate", " ", "expressions", " ", 
      RowBox[{"(", 
       RowBox[{
       "many", " ", "violations", " ", "have", " ", "same", " ", "form"}], 
       ")"}], " ", "This", " ", "dramatically", " ", "reduces", " ", "work", " ",
       "for", " ", "FullSimplify", " ", "Example"}], ":", 
     RowBox[{"For", " ", "12", " ", "states"}]}], ",", 
    RowBox[{
     RowBox[{"66", " ", "pairs"}], "\[RightArrow]", 
     RowBox[{"might", " ", "reduce", " ", 
      RowBox[{"to", "~", "10"}], " ", "unique", " ", "forms"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uniqueViolations", "=", 
    RowBox[{"DeleteDuplicates", "[", "nonZero", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Unique violations to simplify: \>\"", ",", 
     RowBox[{"Length", "[", "uniqueViolations", "]"}], 
     ",", "\"\< (reduced from \>\"", ",", 
     RowBox[{"Length", "[", "nonZero", "]"}], ",", "\"\<)\>\""}], "]"}], 
   ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"STEP", " ", "5"}], ":", 
      RowBox[{
      "Apply", " ", "FullSimplify", " ", "to", " ", "prove", " ", 
       "violations"}]}], "=", 
     RowBox[{
      RowBox[{
      "0", " ", "FullSimplify", " ", "uses", " ", "algebraic", " ", 
       "manipulation", " ", "to", " ", "simplify", " ", "expressions", " ", 
       "If", " ", "result"}], "\[NotEqual]", "0"}]}], ",", 
    RowBox[{"detailed", " ", "balance", " ", "is", " ", 
     RowBox[{"violated", "!"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "uniqueViolations", "]"}], ">", "0"}], ",", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Applying FullSimplify to unique violations...\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Use", " ", "parallel", " ", "processing", " ", "for", " ", "speed"}], 
       "*)"}], 
      RowBox[{"simplifiedUnique", "=", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{"FullSimplify", ",", "uniqueViolations"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Check", " ", "which", " ", "violations", " ", "remain", " ", "non"}],
         "-", 
        RowBox[{"zero", " ", "after", " ", "simplification"}]}], "*)"}], 
      RowBox[{"remainingViolations", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"simplifiedUnique", ",", 
         RowBox[{
          RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"REPORT", " ", "RESULTS"}], "*)"}], 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\\nDetailed balance: \>\"", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "remainingViolations", "]"}], "==", "0"}], 
          ",", "\"\<SATISFIED (all unique violations symbolically reduced to \
0)\>\"", ",", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "remainingViolations", "]"}], "]"}], 
           "<>", "\"\< unique violations remain after FullSimplify\>\""}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", " ", "violations", " ", "remain"}], ",", 
        RowBox[{"show", " ", "them", " ", 
         RowBox[{"(", 
          RowBox[{"up", " ", "to", " ", "3"}], ")"}]}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "remainingViolations", "]"}], ">", "0"}], "&&", 
         RowBox[{
          RowBox[{"Length", "[", "remainingViolations", "]"}], "<=", "3"}]}], 
        ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Remaining violations: \>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"remainingViolations", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "remainingViolations", "]"}]}], "}"}]}], 
          "]"}]}]}], "]"}], ";"}], ",", 
     RowBox[{"(*", 
      RowBox[{"All", " ", "violations", " ", "were", " ", "literal", " ", 
       RowBox[{"zeros", "!"}]}], "*)"}], 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<\\nDetailed balance: SATISFIED (all violations are \
literal zeros)\>\"", "]"}], ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"VISUALIZE", " ", "DECISION", " ", "TREES"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Display", " ", "decision", " ", "trees", " ", "for", " ", "first", " ", 
    "few", " ", "states", " ", "Useful", " ", "for", " ", "understanding", " ",
     "how", " ", "bit", " ", "sequences", " ", "map", " ", "to", " ", 
    "outcomes"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<\\nDecision tree for first state:\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tree1", "=", 
   RowBox[{"VisualizeDecisionTree", "[", 
    RowBox[{"states", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "tree1", "]"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "states", "]"}], ">", "1"}], ",", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<\\nDecision tree for second state:\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tree2", "=", 
       RowBox[{"VisualizeDecisionTree", "[", 
        RowBox[{"states", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Print", "[", "tree2", "]"}], ";"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"END", " ", "OF", " ", "CODE"}], "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SUMMARY", " ", "OF", " ", "EXECUTION", " ", 
     RowBox[{"FLOW", ":", 
      RowBox[{"1.", " ", "SETUP"}], ":", 
      RowBox[{"Define", " ", "L"}]}]}], ",", "nParticles", ",", 
    RowBox[{
     RowBox[{
     "create", " ", "symbolic", " ", "J", " ", "matrix", " ", "2.", " ", 
      "GENERATE", " ", 
      RowBox[{"STATES", ":", 
       RowBox[{
       "Create", " ", "all", " ", "possible", " ", "particle", " ", 
        "configurations", " ", "3.", " ", "BUILD", " ", "TRANSITION", " ", 
        "MATRIX", " ", 
        RowBox[{"(", 
         RowBox[{"the", " ", "main", " ", "computation"}], ")"}]}], ":", 
       RowBox[{"For", " ", "each", " ", 
        RowBox[{"state", ":", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Enumerate"}], " ", "all", " ", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"nBits", "+", "nExtraBits"}], ")"}]}], " ", "bit", " ", 
           "sequences"}], "-", 
          RowBox[{"For", " ", "each", " ", "bit", " ", "sequence"}]}], ":", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "*", "Set", " ", "$BinaryChoices", " ", "to", " ", "that", " ", 
           "sequence", "*", "Call", " ", "KawasakiMoveFromBits", " ", "which",
            " ", "consumes", " ", "bits", "*", "Record", " ", "outcome", " ", 
           
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"accept", "/", "reject"}], "/", "no"}], "-", 
             RowBox[{"swap", " ", "with", " ", "probabilities"}]}], ")"}]}], "-", 
          RowBox[{
          "Merge", " ", "outcomes", " ", "to", " ", "get", " ", "state"}], "-",
           "to", "-", 
          RowBox[{"state", " ", "transitions"}], "-", 
          RowBox[{
          "Fill", " ", "transition", " ", "matrix", " ", "4.", " ", "VERIFY", 
           " ", "DETAILED", " ", 
           RowBox[{"BALANCE", ":", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "Calculate"}], " ", "Boltzmann", " ", "weights"}], 
             "-", 
             RowBox[{"Check", " ", "\[Pi]", 
              RowBox[{"(", "i", ")"}], "\[Times]", "P", 
              RowBox[{"(", 
               RowBox[{"i", "\[RightArrow]", "j"}], ")"}]}]}]}]}]}]}]}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Pi]", 
        RowBox[{"(", "j", ")"}], "\[Times]", "P", 
        RowBox[{"(", 
         RowBox[{"j", "\[RightArrow]", "i"}], ")"}], " ", "for", " ", "all", " ",
         "pairs"}], "-", 
       RowBox[{
       "Use", " ", "FullSimplify", " ", "to", " ", "prove", " ", 
        "violations"}]}], "=", 
      RowBox[{"0", " ", "5.", " ", 
       RowBox[{"VISUALIZE", ":", 
        RowBox[{
        "Display", " ", "decision", " ", "trees", " ", "for", " ", 
         "inspection", " ", "KEY", " ", "INSIGHT"}], ":", 
        RowBox[{"No", " ", "actual", " ", "randomness", " ", "is", " ", 
         RowBox[{"used", "!"}], " ", "All", " ", "possible", " ", "random", " ",
          "outcomes", " ", "are", " ", "enumerated", " ", 
         RowBox[{"symbolically", "."}]}]}]}]}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.978091376178439*^9, {3.978091538909196*^9, 3.978091551575264*^9}, {
   3.978091629856573*^9, 3.978091632289256*^9}, {3.978091670076981*^9, 
   3.978091677536317*^9}, {3.978091822798211*^9, 3.9780919063213177`*^9}, 
   3.9780920004489403`*^9, {3.9780920589078836`*^9, 3.9780921205481243`*^9}, {
   3.978092221488656*^9, 3.97809222158663*^9}, {3.97809240706104*^9, 
   3.9780924474033422`*^9}, {3.978092558697817*^9, 3.978092581328417*^9}, {
   3.9780926225439377`*^9, 3.978092622662011*^9}, {3.978093103284684*^9, 
   3.97809311050381*^9}, {3.978093160828961*^9, 3.978093196819219*^9}, {
   3.978165899316415*^9, 3.978165926940547*^9}, {3.9781659853291807`*^9, 
   3.978166001207934*^9}, {3.978166294158469*^9, 3.978166318582901*^9}, {
   3.978166348978299*^9, 3.9781663505499687`*^9}, {3.978166965766571*^9, 
   3.978166965875231*^9}, {3.978167251555888*^9, 3.978167253168601*^9}, {
   3.978167594274741*^9, 3.978167597138795*^9}, {3.978168683594182*^9, 
   3.9781686837845917`*^9}, {3.9781688056745987`*^9, 3.9781688057608767`*^9}},
 
 CellLabel->
  "In[6924]:=",ExpressionUUID->"833bdccd-bae2-4554-88b3-283c06e7dde3"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"L = \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["L = ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.9781688070663357`*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"ebd02cc0-37c1-4891-90dd-e95a28f742fd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nParticles = \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["nParticles = ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.978168807067581*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"6905d202-dae7-4a33-8f05-99bdf455cad8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Extra bits for moves: \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["Extra bits for moves: ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.97816880706883*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"1fa0fb90-f55c-4d51-9a1b-23132f5c9929"],

Cell[BoxData["\<\"J Matrix:\"\>"], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.978168807069886*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"076bdb10-7aea-4a9c-b6b7-a91f3e164f2e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "J01", "J02"},
     {"J01", "0", "J12"},
     {"J02", "J12", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.9781688070708933`*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"c57736b0-c821-40b6-8dee-0504da0ea231"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total configurations: \"\>", "\[InvisibleSpace]", "12"}],
  SequenceForm["Total configurations: ", 12],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.9781688070718203`*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"6c65ddf9-e032-48ce-a23a-50c8ae33c8aa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"First few: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "}"}]}], "}"}]}],
  SequenceForm[
  "First few: ", {{1, 2, 0, 0}, {2, 1, 0, 0}, {1, 0, 2, 0}, {2, 0, 1, 0}, {1, 
   0, 0, 2}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.978168807072907*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"890cfe86-7b5b-4d74-b7bd-73a962e028bc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\nTransition matrix row sums: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
      ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm[
  "\nTransition matrix row sums: ", {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.9781688071108522`*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"147d7674-6064-41c6-8fd8-10f94769daf0"],

Cell[BoxData["\<\"Transition matrix:\"\>"], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.978168807112637*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"8d3704c0-cb40-40a2-8d7a-ad235c59889c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "4"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{"J12", "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
                  RowBox[{"J12", ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], 
      FractionBox["1", "4"], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0"},
     {
      FractionBox["1", "4"], 
      RowBox[{
       FractionBox["1", "4"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{"J12", "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
                  RowBox[{"J12", ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0"},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}]},
     {"0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0"},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{"J12", "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
                  RowBox[{"J12", ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], 
      FractionBox["1", "4"], "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], 
      FractionBox["1", "4"], 
      RowBox[{
       FractionBox["1", "4"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{"J12", "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
                  RowBox[{"J12", ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{"J12", "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
                  RowBox[{"J12", ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], 
      FractionBox["1", "4"], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", 
      FractionBox["1", "4"], 
      RowBox[{
       FractionBox["1", "4"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{"J12", "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
                  RowBox[{"J12", ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0"},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"-", "J12"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"J12", " ", "\[Beta]"}]], 
               RowBox[{
                RowBox[{"-", "J12"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}]},
     {"0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{"J12", "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
                  RowBox[{"J12", ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], 
      FractionBox["1", "4"]},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{"J12", "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
               RowBox[{"J12", ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], 
      FractionBox["1", "4"], 
      RowBox[{
       FractionBox["1", "4"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{"J12", "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "J12"}], " ", "\[Beta]"}]], 
                  RowBox[{"J12", ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.9781688071213408`*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"a299081a-3bb9-478a-b843-511f450a35a9"],

Cell[BoxData["\<\"Computing detailed balance violations...\"\>"], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.978168807127252*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"ac4413d5-d577-4d05-8d41-4baedba75c02"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Non-literal-zero violations: \"\>", "\[InvisibleSpace]", "16"}],
  SequenceForm["Non-literal-zero violations: ", 16],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.9781688071285353`*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"d0eabb61-4021-4cb6-b211-475c8c530c0e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Unique violations to simplify: \"\>", "\[InvisibleSpace]", "2",
    "\[InvisibleSpace]", "\<\" (reduced from \"\>", "\[InvisibleSpace]", "16",
    "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm[
  "Unique violations to simplify: ", 2, " (reduced from ", 16, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.978168807129785*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"82993d0a-6461-4742-b696-46a6469fd45a"],

Cell[BoxData["\<\"Applying FullSimplify to unique violations...\"\>"], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.978168807130683*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"e0ce4a88-34fe-4b71-8947-85deed3d9928"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\nDetailed balance: \"\>", 
   "\[InvisibleSpace]", "\<\"SATISFIED (all unique violations symbolically \
reduced to 0)\"\>"}],
  SequenceForm[
  "\nDetailed balance: ", 
   "SATISFIED (all unique violations symbolically reduced to 0)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.978168807152755*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"fcc88a06-7c1d-41d3-9d96-c1420e0b0e6d"],

Cell[BoxData["\<\"\\nDecision tree for first state:\"\>"], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.9781688071543083`*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"c7e06b7e-2ac9-47c8-bf3d-87fee60ec583"],

Cell[BoxData[
 PaneBox[
  GraphicsBox[{{{{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-28., 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-28., 2}, {-36.4, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-28., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-36.4, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-41.2, -3.7}, {-38.8, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-28., 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-36.4, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{2, 1, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[FractionBox[\\\"1\\\", \
\\\"4\\\"], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-40., -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-18.666666666666664`, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-18.666666666666664`, 2}, {-24.266666666666666`, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-18.666666666666664`, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-24.266666666666666`, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-27.866666666666664, -3.7}, \
{-25.466666666666665, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-18.666666666666664, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-24.266666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[\\\"0\\\", TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-26.666666666666664, -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-9.333333333333332, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-9.333333333333332, 2}, {-12.133333333333333`, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-9.333333333333332, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-12.133333333333333`, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-14.533333333333331, -3.7}, \
{-12.133333333333333, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-9.333333333333332, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-12.133333333333333, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 0, 2, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \
\\\"0\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"J12\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], \
TagBox[\\\"True\\\", \\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-13.333333333333332, -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {0., 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0., 2}, {0., 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{0., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{0., 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-1.2, -3.7}, {1.2, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {0., 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {0., 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \\\"0\\\"}]}, \
{SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \\\"J12\\\
\"}], \\\" \\\", \\\"\[Beta]\\\"}]], TagBox[\\\"True\\\", \
\\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 1.2`], Rule[ColumnWidths, Automatic], \
Rule[AllowedDimensions, List[2, Automatic]], Rule[Selectable, True], \
Rule[Editable, True]]}}, Rule[ColumnAlignments, List[Left]], \
Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], \\\")\\\"}]}], \
TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {0., -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {9.333333333333332, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{9.333333333333332, 2}, {12.133333333333333`, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{9.333333333333332, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{12.133333333333333`, 0}, 0.2]}, 
       {GrayLevel[0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{12.133333333333333, -3.7}, \
{14.533333333333331, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {9.333333333333332, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {12.133333333333333, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0.5],
             FrontFaceColor->GrayLevel[0.5],
             BackFaceColor->GrayLevel[0.5],
             GraphicsColor->GrayLevel[0.5],
             FontSize->12,
             FontColor->GrayLevel[0.5]]},
           {
            StyleBox["\<\"no-swap\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0.5],
             FrontFaceColor->GrayLevel[0.5],
             BackFaceColor->GrayLevel[0.5],
             GraphicsColor->GrayLevel[0.5],
             FontSize->10,
             FontColor->GrayLevel[0.5]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {13.333333333333332, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {18.666666666666664`, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{18.666666666666664`, 2}, {24.266666666666666`, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{18.666666666666664`, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{24.266666666666666`, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{25.466666666666665, -3.7}, \
{27.866666666666664, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {18.666666666666664, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {24.266666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{0, 2, 0, 1}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \
\\\"0\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"J12\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], \
TagBox[\\\"True\\\", \\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {26.666666666666664, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {28., 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{28., 2}, {36.4, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{28., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{36.4, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{38.8, -3.7}, {41.2, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {28., 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {36.4, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \\\"0\\\"}]}, \
{SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \\\"J12\\\
\"}], \\\" \\\", \\\"\[Beta]\\\"}]], TagBox[\\\"True\\\", \
\\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 1.2`], Rule[ColumnWidths, Automatic], \
Rule[AllowedDimensions, List[2, Automatic]], Rule[Selectable, True], \
Rule[Editable, True]]}}, Rule[ColumnAlignments, List[Left]], \
Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], \\\")\\\"}]}], \
TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {40., -3}]}}}, {
     {RGBColor[0.87, 0.94, 1], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
      DiskBox[{0, 4}, 0.4]}, InsetBox[
      StyleBox["\<\"START\\n{1, 2, 0, 0}\"\>",
       StripOnInput->False,
       FontSize->14,
       FontWeight->Bold], {0, 4}]}},
   AspectRatio->0.4,
   Background->GrayLevel[1],
   PlotRange->{{-50, 50}, {-4, 6}}],
  ImageSize->{1800, 600},
  Scrollbars->True]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.97816880720476*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"ea71a4cc-55c2-44b8-95a9-d552d6c2a858"],

Cell[BoxData["\<\"\\nDecision tree for second state:\"\>"], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.97816880721439*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"ef068b5d-1a84-4201-baff-029c6f420478"],

Cell[BoxData[
 PaneBox[
  GraphicsBox[{{{{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-28., 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-28., 2}, {-36.4, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-28., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-36.4, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-41.2, -3.7}, {-38.8, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-28., 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-36.4, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[FractionBox[\\\"1\\\", \
\\\"4\\\"], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-40., -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-18.666666666666664`, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-18.666666666666664`, 2}, {-24.266666666666666`, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-18.666666666666664`, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-24.266666666666666`, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-27.866666666666664, -3.7}, \
{-25.466666666666665, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-18.666666666666664, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-24.266666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{2, 1, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[\\\"0\\\", TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-26.666666666666664, -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-9.333333333333332, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-9.333333333333332, 2}, {-12.133333333333333`, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-9.333333333333332, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-12.133333333333333`, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-14.533333333333331, -3.7}, \
{-12.133333333333333, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-9.333333333333332, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-12.133333333333333, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{2, 0, 1, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \
\\\"0\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"J12\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], \
TagBox[\\\"True\\\", \\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-13.333333333333332, -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {0., 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0., 2}, {0., 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{0., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{0., 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-1.2, -3.7}, {1.2, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {0., 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {0., 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{2, 1, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \\\"0\\\"}]}, \
{SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \\\"J12\\\
\"}], \\\" \\\", \\\"\[Beta]\\\"}]], TagBox[\\\"True\\\", \
\\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 1.2`], Rule[ColumnWidths, Automatic], \
Rule[AllowedDimensions, List[2, Automatic]], Rule[Selectable, True], \
Rule[Editable, True]]}}, Rule[ColumnAlignments, List[Left]], \
Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], \\\")\\\"}]}], \
TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {0., -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {9.333333333333332, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{9.333333333333332, 2}, {12.133333333333333`, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{9.333333333333332, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{12.133333333333333`, 0}, 0.2]}, 
       {GrayLevel[0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{12.133333333333333, -3.7}, \
{14.533333333333331, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {9.333333333333332, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {12.133333333333333, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{2, 1, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0.5],
             FrontFaceColor->GrayLevel[0.5],
             BackFaceColor->GrayLevel[0.5],
             GraphicsColor->GrayLevel[0.5],
             FontSize->12,
             FontColor->GrayLevel[0.5]]},
           {
            StyleBox["\<\"no-swap\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0.5],
             FrontFaceColor->GrayLevel[0.5],
             BackFaceColor->GrayLevel[0.5],
             GraphicsColor->GrayLevel[0.5],
             FontSize->10,
             FontColor->GrayLevel[0.5]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {13.333333333333332, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {18.666666666666664`, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{18.666666666666664`, 2}, {24.266666666666666`, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{18.666666666666664`, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{24.266666666666666`, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{25.466666666666665, -3.7}, \
{27.866666666666664, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {18.666666666666664, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {24.266666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{0, 1, 0, 2}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \
\\\"0\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"J12\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], \
TagBox[\\\"True\\\", \\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {26.666666666666664, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {28., 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{28., 2}, {36.4, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{28., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{36.4, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{38.8, -3.7}, {41.2, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {28., 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {36.4, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{2, 1, 0, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \\\"0\\\"}]}, \
{SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \\\"J12\\\
\"}], \\\" \\\", \\\"\[Beta]\\\"}]], TagBox[\\\"True\\\", \
\\\"PiecewiseDefault\\\", Rule[AutoDelete, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 1.2`], Rule[ColumnWidths, Automatic], \
Rule[AllowedDimensions, List[2, Automatic]], Rule[Selectable, True], \
Rule[Editable, True]]}}, Rule[ColumnAlignments, List[Left]], \
Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], \\\")\\\"}]}], \
TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {40., -3}]}}}, {
     {RGBColor[0.87, 0.94, 1], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
      DiskBox[{0, 4}, 0.4]}, InsetBox[
      StyleBox["\<\"START\\n{2, 1, 0, 0}\"\>",
       StripOnInput->False,
       FontSize->14,
       FontWeight->Bold], {0, 4}]}},
   AspectRatio->0.4,
   Background->GrayLevel[1],
   PlotRange->{{-50, 50}, {-4, 6}}],
  ImageSize->{1800, 600},
  Scrollbars->True]], "Print",
 CellChangeTimes->{
  3.978091376816226*^9, 3.9780915518800163`*^9, 3.978091632555472*^9, {
   3.978091670467063*^9, 3.978091677784237*^9}, {3.978091828055633*^9, 
   3.978091833655787*^9}, {3.978091867792871*^9, 3.9780919091353807`*^9}, 
   3.978092001894207*^9, {3.978092093167549*^9, 3.978092121779333*^9}, 
   3.978092222025428*^9, 3.978092433137425*^9, 3.978092494866353*^9, {
   3.9780926000101337`*^9, 3.978092623967688*^9}, 3.9780931113066463`*^9, {
   3.9780931485984907`*^9, 3.9780931614908447`*^9}, 3.978093199208737*^9, {
   3.978165864924035*^9, 3.978165929324471*^9}, 3.9781662115023317`*^9, {
   3.978166311321478*^9, 3.9781663189072523`*^9}, 3.978166351718347*^9, 
   3.978166969502503*^9, 3.9781672685357723`*^9, 3.978167597535639*^9, 
   3.978168686150177*^9, 3.9781688072369432`*^9},
 CellLabel->
  "During evaluation of \
In[6924]:=",ExpressionUUID->"03d016f6-9a85-41ff-83ad-92d8a3b9c515"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"NUMERICAL", " ", "SIMULATION"}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "random", " ", "symmetric", " ", "J", " ", "matrix"}], 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"GenerateRandomJMatrix", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "J", "}"}], ",", 
      RowBox[{
       RowBox[{"J", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"n", "+", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "<", "j"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
             RowBox[{"J", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "J"}]}], "]"}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Set", " ", "numerical", " ", "values"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SeedRandom", "[", "1", "]"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "for", " ", "reproducibility", " ", "of", " ", "J", " ", "matrix"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"JMatrixNum", "=", 
     RowBox[{"GenerateRandomJMatrix", "[", "nParticles", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Beta]Num", "=", "1.0"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Numerical J Matrix:\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"JMatrixNum", "//", "MatrixForm"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "numerical", " ", "energy", " ", "function"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"NumericalEnergy", "[", "lattice_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"E", "=", "0"}], ",", "i", ",", "j"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "==", 
              RowBox[{"Length", "[", "lattice", "]"}]}], ",", "1", ",", 
             RowBox[{"i", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"lattice", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "!=", "0"}], "&&", 
             RowBox[{
              RowBox[{"lattice", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "!=", "0"}]}], ",", 
            RowBox[{"E", "-=", 
             RowBox[{"JMatrixNum", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"lattice", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
                RowBox[{
                 RowBox[{"lattice", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
              "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "lattice", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "E"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Replace", " ", "symbolic", " ", "J", " ", "and", " ", "\[Beta]", " ", 
     "with", " ", "numerical", " ", "values", " ", "for", " ", "MCMC"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"JMatrix", "=", "JMatrixNum"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Beta]", "=", "\[Beta]Num"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Initial", " ", "state"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"currentState", "=", 
     RowBox[{"states", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Number", " ", "of", " ", "iterations"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"nSteps", "=", "1000000"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Run", " ", "simulation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SeedRandom", "[", "12", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"trajectory", "=", 
     RowBox[{"NestList", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"lattice", ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nBits", ",", "bits", ",", "result"}], "}"}], ",", 
           RowBox[{
            RowBox[{"nBits", "=", 
             RowBox[{"Ceiling", "[", 
              RowBox[{"Log2", "[", 
               RowBox[{"Length", "[", "lattice", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"bits", "=", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", "nBits"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"$BinaryChoices", "=", "bits"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"$BinaryIndex", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"result", "=", 
             RowBox[{"TESTFUNCTION", "[", "lattice", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "result", "]"}], 
               "===", "\"\<no-swap\>\""}], ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RandomReal", "[", "]"}], "<", 
                 RowBox[{"result", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
                RowBox[{"result", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"result", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}]}]}],
           "]"}]}], "]"}], ",", "currentState", ",", "nSteps"}], "]"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Print", " ", "first", " ", "few", " ", "states"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<First 10 states:\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Take", "[", 
      RowBox[{"trajectory", ",", "10"}], "]"}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Count", " ", "state", " ", "frequencies"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stateCounts", "=", 
     RowBox[{"Counts", "[", "trajectory", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\nState frequencies:\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"stateCounts", "//", "Normal"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.978092192587294*^9, {3.978092591393561*^9, 3.978092595172435*^9}, {
   3.978166593192123*^9, 3.978166621077361*^9}, 3.978168620243222*^9, 
   3.978168815390079*^9},
 CellLabel->
  "In[6969]:=",ExpressionUUID->"107334fb-2494-4c56-937b-f4fa6ad0a8de"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Numerical J Matrix:\"\>"], "Print",
 CellChangeTimes->{
  3.978092193594987*^9, 3.978092230824561*^9, 3.978166325338812*^9, {
   3.978166594037181*^9, 3.97816662196917*^9}, 3.978166993361768*^9, 
   3.978168622401791*^9, 3.978168736478713*^9, 3.978168816588333*^9},
 CellLabel->
  "During evaluation of \
In[6969]:=",ExpressionUUID->"8886d262-8a5f-4398-8bf4-55c810abb29e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0.6347789803421424`", 
      RowBox[{"-", "0.7771607777375271`"}]},
     {"0.6347789803421424`", "0", "0.5790519892677031`"},
     {
      RowBox[{"-", "0.7771607777375271`"}], "0.5790519892677031`", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.978092193594987*^9, 3.978092230824561*^9, 3.978166325338812*^9, {
   3.978166594037181*^9, 3.97816662196917*^9}, 3.978166993361768*^9, 
   3.978168622401791*^9, 3.978168736478713*^9, 3.978168816590044*^9},
 CellLabel->
  "During evaluation of \
In[6969]:=",ExpressionUUID->"007af033-7f23-457b-ab30-058cfc095985"],

Cell[BoxData["\<\"First 10 states:\"\>"], "Print",
 CellChangeTimes->{
  3.978092193594987*^9, 3.978092230824561*^9, 3.978166325338812*^9, {
   3.978166594037181*^9, 3.97816662196917*^9}, 3.978166993361768*^9, 
   3.978168622401791*^9, 3.978168736478713*^9, 3.978168898898513*^9},
 CellLabel->
  "During evaluation of \
In[6969]:=",ExpressionUUID->"a67f15a5-09e9-47a8-baaf-49c4272caa78"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.978092193594987*^9, 3.978092230824561*^9, 3.978166325338812*^9, {
   3.978166594037181*^9, 3.97816662196917*^9}, 3.978166993361768*^9, 
   3.978168622401791*^9, 3.978168736478713*^9, 3.978168898905437*^9},
 CellLabel->
  "During evaluation of \
In[6969]:=",ExpressionUUID->"55a3094b-6a13-47e8-abaa-6cf9e9910af7"],

Cell[BoxData["\<\"\\nState frequencies:\"\>"], "Print",
 CellChangeTimes->{
  3.978092193594987*^9, 3.978092230824561*^9, 3.978166325338812*^9, {
   3.978166594037181*^9, 3.97816662196917*^9}, 3.978166993361768*^9, 
   3.978168622401791*^9, 3.978168736478713*^9, 3.978168899359373*^9},
 CellLabel->
  "During evaluation of \
In[6969]:=",ExpressionUUID->"8e00ff85-8e0e-4843-8281-860ee8388251"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "}"}], "\[Rule]", "96806"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "}"}], "\[Rule]", "96492"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "}"}], "\[Rule]", "54638"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0", ",", "2"}], "}"}], "\[Rule]", "53954"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "}"}], "\[Rule]", "97319"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "}"}], "\[Rule]", "99108"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "}"}], "\[Rule]", "98030"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "2"}], "}"}], "\[Rule]", "99138"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "2", ",", "1"}], "}"}], "\[Rule]", "97524"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "}"}], "\[Rule]", "54151"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "0"}], "}"}], "\[Rule]", "97580"}],
    ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "2", ",", "0", ",", "1"}], "}"}], "\[Rule]", 
    "55261"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.978092193594987*^9, 3.978092230824561*^9, 3.978166325338812*^9, {
   3.978166594037181*^9, 3.97816662196917*^9}, 3.978166993361768*^9, 
   3.978168622401791*^9, 3.978168736478713*^9, 3.978168899361145*^9},
 CellLabel->
  "During evaluation of \
In[6969]:=",ExpressionUUID->"a1bf1fd1-e91f-412a-af21-a7318b567890"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"BOLTZMANN", " ", "DISTRIBUTION", " ", "ANALYSIS"}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Step", " ", "1"}], ":", 
    RowBox[{
    "Calculate", " ", "energy", " ", "for", " ", "each", " ", "state"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"energies", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NumericalEnergy", "[", 
        RowBox[{"states", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Step", " ", "2"}], "&"}], " ", "3"}], ":", 
     RowBox[{"Calculate", " ", "Boltzmann", " ", "distribution"}]}], "*)"}], 
   RowBox[{
    RowBox[{"boltzmannWeights", "=", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[Beta]Num"}], "*", "energies"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"partitionFunction", "=", 
     RowBox[{"Total", "[", "boltzmannWeights", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"theoreticalProbs", "=", 
     RowBox[{"boltzmannWeights", "/", "partitionFunction"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Step", " ", "4"}], ":", 
     RowBox[{
      RowBox[{
      "Get", " ", "observed", " ", "probabilities", " ", "from", " ", 
       "simulation"}], "-", "FIXED"}]}], "*)"}], 
   RowBox[{
    RowBox[{"observedCounts", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"stateCounts", ",", 
           RowBox[{"states", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"stateCounts", "[", 
          RowBox[{"states", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Observed counts: \>\"", ",", "observedCounts"}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Total observations: \>\"", ",", 
      RowBox[{"Total", "[", "observedCounts", "]"}]}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Only", " ", "calculate", " ", "probabilities", " ", "if", " ", "we", " ",
      "have", " ", "observations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", "observedCounts", "]"}], ">", "0"}], ",", 
      RowBox[{"observedProbs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"observedCounts", "/", 
         RowBox[{"Total", "[", "observedCounts", "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<ERROR: No observations found!\>\"", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"observedProbs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "states", "]"}], "}"}]}], "]"}]}], ";"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Scatter", " ", 
     RowBox[{"plot", ":", 
      RowBox[{"theory", " ", "vs", " ", "observed"}]}]}], "*)"}], 
   RowBox[{
    RowBox[{"scatterPlot", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"theoreticalProbs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"observedProbs", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"PointSize", "[", "0.015", "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "->", "\"\<Boltzmann Theory vs Simulation\>\""}], 
       ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Theoretical Probability\>\"", 
          ",", "\"\<Observed Probability\>\""}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "->", "1"}], ",", 
       RowBox[{"Epilog", "->", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Gray", ",", 
          RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", "theoreticalProbs", "]"}], ",", 
               RowBox[{"Max", "[", "theoreticalProbs", "]"}]}], "}"}]}], 
            "}"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Max", "[", "theoreticalProbs", "]"}], "*", "1.1"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Max", "[", "observedProbs", "]"}], "*", "1.1"}]}], 
           "}"}]}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Calculate", " ", "correlation", " ", "coefficient"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"correlation", "=", 
     RowBox[{"Correlation", "[", 
      RowBox[{"theoreticalProbs", ",", "observedProbs"}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\\n\>\"", "<>", 
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<=\>\"", ",", "60"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<CORRELATION ANALYSIS\>\"", "]"}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"StringRepeat", "[", 
      RowBox[{"\"\<=\>\"", ",", "60"}], "]"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Pearson correlation coefficient: \>\"", ",", 
      RowBox[{"NumberForm", "[", 
       RowBox[{"correlation", ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\n\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "scatterPlot", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{3.978092206986628*^9},
 CellLabel->
  "In[6987]:=",ExpressionUUID->"6a23bd53-39d0-41cc-b815-9efac9829c0b"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Observed counts: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "96806", ",", "96492", ",", "54151", ",", "54638", ",", "97319", ",", 
     "99108", ",", "97580", ",", "98030", ",", "53954", ",", "55261", ",", 
     "99138", ",", "97524"}], "}"}]}],
  SequenceForm[
  "Observed counts: ", {96806, 96492, 54151, 54638, 97319, 99108, 97580, 
   98030, 53954, 55261, 99138, 97524}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9780922075421124`*^9, 3.9780922384021053`*^9, 
  3.978166331678658*^9, 3.978166610590908*^9, 3.978166781703376*^9, 
  3.978167151794093*^9, 3.9781686559787283`*^9, 3.978168746570415*^9, 
  3.978168918376091*^9},
 CellLabel->
  "During evaluation of \
In[6987]:=",ExpressionUUID->"f1e4185d-3e4c-40fd-a548-37dd96dff3e3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total observations: \"\>", "\[InvisibleSpace]", "1000001"}],
  SequenceForm["Total observations: ", 1000001],
  Editable->False]], "Print",
 CellChangeTimes->{3.9780922075421124`*^9, 3.9780922384021053`*^9, 
  3.978166331678658*^9, 3.978166610590908*^9, 3.978166781703376*^9, 
  3.978167151794093*^9, 3.9781686559787283`*^9, 3.978168746570415*^9, 
  3.978168918377377*^9},
 CellLabel->
  "During evaluation of \
In[6987]:=",ExpressionUUID->"10520de2-12d9-4d11-bb0b-d098793e5c12"],

Cell[BoxData["\<\"\\n=========================================================\
===\"\>"], "Print",
 CellChangeTimes->{3.9780922075421124`*^9, 3.9780922384021053`*^9, 
  3.978166331678658*^9, 3.978166610590908*^9, 3.978166781703376*^9, 
  3.978167151794093*^9, 3.9781686559787283`*^9, 3.978168746570415*^9, 
  3.9781689184131737`*^9},
 CellLabel->
  "During evaluation of \
In[6987]:=",ExpressionUUID->"db19996a-2c59-4160-9c82-73cc11a5d6ff"],

Cell[BoxData["\<\"CORRELATION ANALYSIS\"\>"], "Print",
 CellChangeTimes->{3.9780922075421124`*^9, 3.9780922384021053`*^9, 
  3.978166331678658*^9, 3.978166610590908*^9, 3.978166781703376*^9, 
  3.978167151794093*^9, 3.9781686559787283`*^9, 3.978168746570415*^9, 
  3.978168918415351*^9},
 CellLabel->
  "During evaluation of \
In[6987]:=",ExpressionUUID->"d42539d7-f05e-4152-ba18-fd50e666226d"],

Cell[BoxData["\<\"============================================================\
\"\>"], "Print",
 CellChangeTimes->{3.9780922075421124`*^9, 3.9780922384021053`*^9, 
  3.978166331678658*^9, 3.978166610590908*^9, 3.978166781703376*^9, 
  3.978167151794093*^9, 3.9781686559787283`*^9, 3.978168746570415*^9, 
  3.978168918416916*^9},
 CellLabel->
  "During evaluation of \
In[6987]:=",ExpressionUUID->"14321502-ad81-40e8-9944-a9980c57bcb2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Pearson correlation coefficient: \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     StyleBox["\<\"0.9992\"\>",
      ShowStringCharacters->False],
     0.9992383558623356,
     AutoDelete->True],
    NumberForm[#, {5, 4}]& ]}],
  SequenceForm["Pearson correlation coefficient: ", 
   NumberForm[0.9992383558623356, {5, 4}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.9780922075421124`*^9, 3.9780922384021053`*^9, 
  3.978166331678658*^9, 3.978166610590908*^9, 3.978166781703376*^9, 
  3.978167151794093*^9, 3.9781686559787283`*^9, 3.978168746570415*^9, 
  3.97816891841826*^9},
 CellLabel->
  "During evaluation of \
In[6987]:=",ExpressionUUID->"3faa0f94-a3de-451e-9e46-46a4b21f53e0"],

Cell[BoxData["\<\"\\n\"\>"], "Print",
 CellChangeTimes->{3.9780922075421124`*^9, 3.9780922384021053`*^9, 
  3.978166331678658*^9, 3.978166610590908*^9, 3.978166781703376*^9, 
  3.978167151794093*^9, 3.9781686559787283`*^9, 3.978168746570415*^9, 
  3.97816891841952*^9},
 CellLabel->
  "During evaluation of \
In[6987]:=",ExpressionUUID->"16d8a76e-db0b-4a1e-b8ba-9e380d684acb"],

Cell[BoxData[
 GraphicsBox[{{}, 
   InterpretationBox[{
     TagBox[
      TagBox[
       {RGBColor[1, 0, 0], PointSize[0.015], AbsoluteThickness[2], 
        PointBox[{{0.09763987213566357, 0.0968059031940968}, {
         0.09763987213566357, 0.09649190350809649}, {0.0547202557286729, 
         0.05415094584905415}, {0.0547202557286729, 0.05463794536205464}, {
         0.09763987213566357, 0.09731890268109732}, {0.09763987213566357, 
         0.0991079008920991}, {0.09763987213566357, 0.09757990242009758}, {
         0.09763987213566357, 0.09802990197009803}, {0.0547202557286729, 
         0.053953946046053955`}, {0.0547202557286729, 0.05526094473905526}, {
         0.09763987213566357, 0.09913790086209914}, {0.09763987213566357, 
         0.09752390247609752}}]},
       Annotation[#, "Charting`Private`Tag#1"]& ],
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
     StyleBox[
      DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
        Slot["HighlightElements"], 
        Slot["LayoutOptions"], 
        Slot["Meta"], 
        Charting`HighlightActionFunction["DynamicHighlight", {{
           Annotation[{
             Directive[
              AbsoluteThickness[2], 
              RGBColor[1, 0, 0], 
              PointSize[0.015]], 
             
             Point[{{0.09763987213566357, 0.0968059031940968}, {
              0.09763987213566357, 0.09649190350809649}, {0.0547202557286729, 
              0.05415094584905415}, {0.0547202557286729, 
              0.05463794536205464}, {0.09763987213566357, 
              0.09731890268109732}, {0.09763987213566357, 
              0.0991079008920991}, {0.09763987213566357, 
              0.09757990242009758}, {0.09763987213566357, 
              0.09802990197009803}, {0.0547202557286729, 
              0.053953946046053955`}, {0.0547202557286729, 
              0.05526094473905526}, {0.09763987213566357, 
              0.09913790086209914}, {0.09763987213566357, 
              0.09752390247609752}}]}, "Charting`Private`Tag#1"]}}, <|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0., 0.10740385934922993`}, {0., 
             0.10905169094830906`}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 0}, "ImageSize" -> {576, 576}, 
            "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 1, 
            "DefaultStyle" -> {
              Directive[
               AbsoluteThickness[2], 
               RGBColor[1, 0, 0], 
               PointSize[0.015]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0., 0.10740385934922993`}, {0., 
            0.10905169094830906`}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0}, "ImageSize" -> {576, 576}, 
           "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 1, 
           "DefaultStyle" -> {
             Directive[
              AbsoluteThickness[2], 
              RGBColor[1, 0, 0], 
              PointSize[0.015]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListPlot, "GroupHighlight" -> False|>|>],
       ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
        4.503599627370496*^15, -4.503599627370496*^15}}],
      Selectable->False]},
    Annotation[{{
       Annotation[{
         Directive[
          AbsoluteThickness[2], 
          RGBColor[1, 0, 0], 
          PointSize[0.015]], 
         Point[{{0.09763987213566357, 0.0968059031940968}, {
          0.09763987213566357, 0.09649190350809649}, {0.0547202557286729, 
          0.05415094584905415}, {0.0547202557286729, 0.05463794536205464}, {
          0.09763987213566357, 0.09731890268109732}, {0.09763987213566357, 
          0.0991079008920991}, {0.09763987213566357, 0.09757990242009758}, {
          0.09763987213566357, 0.09802990197009803}, {0.0547202557286729, 
          0.053953946046053955`}, {0.0547202557286729, 0.05526094473905526}, {
          0.09763987213566357, 0.09913790086209914}, {0.09763987213566357, 
          0.09752390247609752}}]}, "Charting`Private`Tag#1"]}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
      "LayoutOptions" -> <|
       "PanelPlotLayout" -> <||>, 
        "PlotRange" -> {{0., 0.10740385934922993`}, {0., 
         0.10905169094830906`}}, "Frame" -> {{False, False}, {False, False}}, 
        "AxesOrigin" -> {0, 0}, "ImageSize" -> {576, 576}, 
        "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 1, 
        "DefaultStyle" -> {
          Directive[
           AbsoluteThickness[2], 
           RGBColor[1, 0, 0], 
           PointSize[0.015]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        ListPlot, "GroupHighlight" -> False|>|>, 
     "DynamicHighlight"]], {{}, {}}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"Theoretical Probability\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox["\"Observed Probability\"", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DefaultBaseStyle->{"PlotGraphics", "Graphics"},
  DisplayFunction->Identity,
  Epilog->{
    Dashing[{Small, Small}], 
    GrayLevel[0.5], 
    Thickness[0.002], 
    LineBox[{{0, 0}, {0.09763987213566357, 0.09763987213566357}}]},
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.24, 0.6, 0.8], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.95, 0.627, 0.1425], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.455, 0.7, 0.21], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.578, 0.51, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.4, 0.64, 1.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1., 0.75, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.8, 0.4, 0.76], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.637, 0.65, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> Automatic, 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "IncludeHighlighting" -> "CurrentPoint", "HighlightStyle" -> Automatic, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotInteractivity:>True,
  PlotLabel->FormBox["\"Boltzmann Theory vs Simulation\"", TraditionalForm],
  PlotRange->{{0., 0.10740385934922993`}, {0., 0.10905169094830906`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{None, None}, {None, None}},
  Ticks->{Automatic, Automatic}]], "Print",
 CellChangeTimes->{3.9780922075421124`*^9, 3.9780922384021053`*^9, 
  3.978166331678658*^9, 3.978166610590908*^9, 3.978166781703376*^9, 
  3.978167151794093*^9, 3.9781686559787283`*^9, 3.978168746570415*^9, 
  3.978168918426786*^9},
 CellLabel->
  "During evaluation of \
In[6987]:=",ExpressionUUID->"e0cf4fe5-98d8-480d-bc15-fe3434391b89"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1324, 775},
WindowMargins->{{Automatic, -136}, {-130, Automatic}},
FrontEndVersion->"14.3 for Mac OS X x86 (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"09b82648-569d-4a7c-ace4-50a7a8158d08"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 246, 4, 67, "Chapter",ExpressionUUID->"49c23e43-c169-4232-b701-8d3112396739"],
Cell[CellGroupData[{
Cell[847, 30, 104182, 2626, 7484, "Input",ExpressionUUID->"833bdccd-bae2-4554-88b3-283c06e7dde3"],
Cell[CellGroupData[{
Cell[105054, 2660, 1054, 19, 23, "Print",ExpressionUUID->"ebd02cc0-37c1-4891-90dd-e95a28f742fd"],
Cell[106111, 2681, 1070, 19, 23, "Print",ExpressionUUID->"6905d202-dae7-4a33-8f05-99bdf455cad8"],
Cell[107184, 2702, 1087, 19, 23, "Print",ExpressionUUID->"1fa0fb90-f55c-4d51-9a1b-23132f5c9929"],
Cell[108274, 2723, 951, 15, 23, "Print",ExpressionUUID->"076bdb10-7aea-4a9c-b6b7-a91f3e164f2e"],
Cell[109228, 2740, 1435, 31, 50, "Print",ExpressionUUID->"c57736b0-c821-40b6-8dee-0504da0ea231"],
Cell[110666, 2773, 1092, 19, 23, "Print",ExpressionUUID->"6c65ddf9-e032-48ce-a23a-50c8ae33c8aa"],
Cell[111761, 2794, 1586, 33, 23, "Print",ExpressionUUID->"890cfe86-7b5b-4d74-b7bd-73a962e028bc"],
Cell[113350, 2829, 1305, 24, 41, "Print",ExpressionUUID->"147d7674-6064-41c6-8fd8-10f94769daf0"],
Cell[114658, 2855, 960, 15, 23, "Print",ExpressionUUID->"8d3704c0-cb40-40a2-8d7a-ad235c59889c"],
Cell[115621, 2872, 80649, 2108, 598, "Print",ExpressionUUID->"a299081a-3bb9-478a-b843-511f450a35a9"],
Cell[196273, 4982, 982, 15, 23, "Print",ExpressionUUID->"ac4413d5-d577-4d05-8d41-4baedba75c02"],
Cell[197258, 4999, 1106, 19, 23, "Print",ExpressionUUID->"d0eabb61-4021-4cb6-b211-475c8c530c0e"],
Cell[198367, 5020, 1254, 22, 23, "Print",ExpressionUUID->"82993d0a-6461-4742-b696-46a6469fd45a"],
Cell[199624, 5044, 987, 15, 23, "Print",ExpressionUUID->"e0ce4a88-34fe-4b71-8947-85deed3d9928"],
Cell[200614, 5061, 1224, 23, 41, "Print",ExpressionUUID->"fcc88a06-7c1d-41d3-9d96-c1420e0b0e6d"],
Cell[201841, 5086, 977, 15, 41, "Print",ExpressionUUID->"c7e06b7e-2ac9-47c8-bf3d-87fee60ec583"],
Cell[202821, 5103, 20592, 469, 608, "Print",ExpressionUUID->"ea71a4cc-55c2-44b8-95a9-d552d6c2a858"],
Cell[223416, 5574, 975, 15, 41, "Print",ExpressionUUID->"ef068b5d-1a84-4201-baff-029c6f420478"],
Cell[224394, 5591, 20595, 469, 608, "Print",ExpressionUUID->"03d016f6-9a85-41ff-83ad-92d8a3b9c515"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[245038, 6066, 8701, 227, 948, "Input",ExpressionUUID->"107334fb-2494-4c56-937b-f4fa6ad0a8de"],
Cell[CellGroupData[{
Cell[253764, 6297, 390, 7, 23, "Print",ExpressionUUID->"8886d262-8a5f-4398-8bf4-55c810abb29e"],
Cell[254157, 6306, 1002, 25, 50, "Print",ExpressionUUID->"007af033-7f23-457b-ab30-058cfc095985"],
Cell[255162, 6333, 387, 7, 23, "Print",ExpressionUUID->"a67f15a5-09e9-47a8-baaf-49c4272caa78"],
Cell[255552, 6342, 1179, 29, 23, "Print",ExpressionUUID->"55a3094b-6a13-47e8-abaa-6cf9e9910af7"],
Cell[256734, 6373, 392, 7, 41, "Print",ExpressionUUID->"8e00ff85-8e0e-4843-8281-860ee8388251"],
Cell[257129, 6382, 1818, 57, 41, "Print",ExpressionUUID->"a1bf1fd1-e91f-412a-af21-a7318b567890"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[258996, 6445, 7222, 194, 744, "Input",ExpressionUUID->"6a23bd53-39d0-41cc-b815-9efac9829c0b"],
Cell[CellGroupData[{
Cell[266243, 6643, 814, 18, 23, "Print",ExpressionUUID->"f1e4185d-3e4c-40fd-a548-37dd96dff3e3"],
Cell[267060, 6663, 528, 11, 23, "Print",ExpressionUUID->"10520de2-12d9-4d11-bb0b-d098793e5c12"],
Cell[267591, 6676, 441, 8, 41, "Print",ExpressionUUID->"db19996a-2c59-4160-9c82-73cc11a5d6ff"],
Cell[268035, 6686, 394, 7, 23, "Print",ExpressionUUID->"d42539d7-f05e-4152-ba18-fd50e666226d"],
Cell[268432, 6695, 436, 8, 23, "Print",ExpressionUUID->"14321502-ad81-40e8-9944-a9980c57bcb2"],
Cell[268871, 6705, 759, 19, 23, "Print",ExpressionUUID->"3faa0f94-a3de-451e-9e46-46a4b21f53e0"],
Cell[269633, 6726, 376, 7, 41, "Print",ExpressionUUID->"16d8a76e-db0b-4a1e-b8ba-9e380d684acb"],
Cell[270012, 6735, 10348, 237, 475, "Print",ExpressionUUID->"e0cf4fe5-98d8-480d-bc15-fe3434391b89"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

