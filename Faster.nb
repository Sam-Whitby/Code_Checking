(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    207755,       5020]
NotebookOptionsPosition[    203665,       4956]
NotebookOutlinePosition[    204058,       4972]
CellTagsIndexPosition[    204015,       4969]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Doing Fewer Computations", "Chapter",
 CellChangeTimes->{{3.978026032197294*^9, 
  3.978026035334795*^9}},ExpressionUUID->"1a73e5e0-7f3a-4441-b576-\
ba0962102138"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "SETUP", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nParticles", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "=", 
    RowBox[{"Symbol", "[", "\"\<\[Beta]\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<L = \>\"", ",", "L"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<nParticles = \>\"", ",", "nParticles"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SYMBOLIC", " ", "J", " ", "MATRIX"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateSymbolicJ", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"J", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"n", "+", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "<", "j"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"J", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<J\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", 
              RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"J", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"j", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"J", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "J"}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"JMatrix", "=", 
    RowBox[{"GenerateSymbolicJ", "[", "nParticles", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<J Matrix:\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"JMatrix", "//", "MatrixForm"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "ENERGY", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymbolicEnergy", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"E", "=", "0"}], ",", "i", ",", "j"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"j", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "==", 
             RowBox[{"Length", "[", "lattice", "]"}]}], ",", "1", ",", 
            RowBox[{"i", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"lattice", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "!=", "0"}], "&&", 
            RowBox[{
             RowBox[{"lattice", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "!=", "0"}]}], ",", 
           RowBox[{"E", "-=", 
            RowBox[{"JMatrix", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"lattice", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
               RowBox[{
                RowBox[{"lattice", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
             "]"}]}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "lattice", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "E"}]}], "]"}]}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "CONFIGURATIONS", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateAllConfigs", "[", 
    RowBox[{"L_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lat", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", "L"}], "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lat", "[", 
              RowBox[{"[", 
               RowBox[{"pos", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{"perm", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "lat"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pos", ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{
           RowBox[{"Range", "[", "L", "]"}], ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"perm", ",", 
         RowBox[{"Permutations", "[", 
          RowBox[{"Range", "[", "n", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     "1"}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"states", "=", 
   RowBox[{"GenerateAllConfigs", "[", 
    RowBox[{"L", ",", "nParticles"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Total configurations: \>\"", ",", 
    RowBox[{"Length", "[", "states", "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<First few: \>\"", ",", 
     RowBox[{"Take", "[", 
      RowBox[{"states", ",", 
       RowBox[{"Min", "[", 
        RowBox[{"5", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "]"}]}], "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"TREE", " ", "RANDOMNESS"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$BinaryChoices", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$BinaryIndex", "=", "1"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BinaryBit", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"$BinaryChoices", "[", 
        RowBox[{"[", "$BinaryIndex", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"$BinaryIndex", "++"}], ";", "\[IndentingNewLine]", "b"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DecodeInteger", "[", "nBits_", "]"}], ":=", 
   RowBox[{"FromDigits", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"BinaryBit", "[", "]"}], ",", 
       RowBox[{"{", "nBits", "}"}]}], "]"}], ",", "2"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"KAWASAKI", " ", "MOVE"}], "\[LongDash]", 
    RowBox[{"normalized", " ", "probabilities"}]}], "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KawasakiMoveFromBits", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsize", ",", "nBits", ",", "raw", ",", "i", ",", "j", ",", "new", ",", 
       "\[CapitalDelta]E", ",", "p", ",", "siteProb"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Lsize", "=", 
       RowBox[{"Length", "[", "lattice", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"siteProb", "=", 
        RowBox[{"1", "/", "Lsize"}]}], "*)"}], " ", 
      RowBox[{"(*", 
       RowBox[{"previous", ",", " ", 
        RowBox[{"but", " ", 
         RowBox[{"isn", "'"}], "t", " ", "normalised"}], ",", " ", 
        RowBox[{
        "probably", " ", "not", " ", "a", " ", "problem", " ", "though"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nBits", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Log2", "[", "Lsize", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"siteProb", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "^", "nBits"}], ")"}]}]}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{
       "Probability", " ", "of", " ", "this", " ", "specific", " ", "bit", " ",
         "pattern"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"raw", "=", 
       RowBox[{"DecodeInteger", "[", "nBits", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", 
       RowBox[{"1", "+", 
        RowBox[{"Mod", "[", 
         RowBox[{"raw", ",", "Lsize"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"j", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "==", "Lsize"}], ",", "1", ",", 
         RowBox[{"i", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"lattice", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "==", 
         RowBox[{"lattice", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<no-swap\>\"", ",", "lattice", ",", "siteProb"}], "}"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"new", "=", "lattice"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"new", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], "]"}], "]"}], "=", 
       RowBox[{"lattice", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]E", "=", 
       RowBox[{
        RowBox[{"SymbolicEnergy", "[", "new", "]"}], "-", 
        RowBox[{"SymbolicEnergy", "[", "lattice", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"\[CapitalDelta]E", "<=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Beta]"}], " ", "\[CapitalDelta]E"}], "]"}], ",", 
            RowBox[{"\[CapitalDelta]E", ">", "0"}]}], "}"}]}], "}"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<accept\>\"", ",", "new", ",", 
          RowBox[{"siteProb", "*", "p"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<reject\>\"", ",", "lattice", ",", 
          RowBox[{"siteProb", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p"}], ")"}]}]}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"TREE", " ", "ENUMERATION"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EnumerateTree", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nBitsForSite", ",", "allBits", ",", "results"}], "}"}], ",", 
     RowBox[{
      RowBox[{"nBitsForSite", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Log2", "[", 
         RowBox[{"Length", "[", "lattice", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allBits", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "nBitsForSite"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"results", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"$BinaryChoices", "=", "bits"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"$BinaryIndex", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"out", "=", 
                 RowBox[{"KawasakiMoveFromBits", "[", "lattice", "]"}]}], 
                "}"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "[", "out", "]"}], 
                  "===", "\"\<no-swap\>\""}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"bits", ",", "\"\<no-swap\>\"", ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"bits", ",", "\"\<accept\>\"", ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"bits", ",", "\"\<reject\>\"", ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}],
                 "]"}]}], "]"}]}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"bits", ",", "allBits"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "results"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"TREE", " ", "VISUALIZATION"}], "\[LongDash]", "BIG", ",", 
    "SCROLLABLE"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualizeDecisionTree", "[", "initialState_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tree", ",", "nBitsForSite", ",", "nBitsTotal", ",", "yLevels", ",", 
       "xSpacing", ",", "nodeRadius", ",", "rootX", ",", "rootY", ",", 
       "pathGraphics", ",", "baseXPositions", ",", "imageWidth", ",", 
       "plotRangeX", ",", "Lsize", ",", "rootGraphics"}], "}"}], ",", 
     RowBox[{
      RowBox[{"tree", "=", 
       RowBox[{"EnumerateTree", "[", "initialState", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Lsize", "=", 
       RowBox[{"Length", "[", "initialState", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nBitsForSite", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Log2", "[", "Lsize", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nBitsTotal", "=", "nBitsForSite"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Use", " ", "a", " ", "wide", " ", "layout", " ", "for", " ", 
        "scrolling"}], "*)"}], 
      RowBox[{"imageWidth", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"1800", ",", 
         RowBox[{
          RowBox[{"Length", "[", "tree", "]"}], "*", "60"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotRangeX", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"50", ",", 
         RowBox[{
          RowBox[{"Length", "[", "tree", "]"}], "*", "3"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yLevels", "=", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"nBitsTotal", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "]"}], "*", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xSpacing", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"20", ",", 
         RowBox[{
          RowBox[{"Length", "[", "tree", "]"}], "*", "1.5"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodeRadius", "=", "0.2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rootX", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rootY", "=", 
       RowBox[{"yLevels", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"baseXPositions", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", "tree", "]"}], "+", "1"}], ")"}], "/", 
             "2"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"xSpacing", "/", "1.5"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "tree", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pathGraphics", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "path", ",", "pathType", ",", "finalState", ",", "probability", ",",
              "currentX", ",", "currentY", ",", "lineGraphics", ",", 
             "circleGraphics", ",", "labelGraphics", ",", "bit", ",", "level",
              ",", "nextX", ",", "nextY", ",", "edgeColor", ",", "leafY", ",",
              "leafX", ",", "leafColor", ",", "leafText", ",", "treeEntry"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"treeEntry", "=", 
             RowBox[{"tree", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"path", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"treeEntry", ",", "1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pathType", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"treeEntry", ",", "2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"finalState", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"treeEntry", ",", "3"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"probability", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"treeEntry", ",", "4"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"currentX", "=", "rootX"}], ";", "\[IndentingNewLine]", 
            RowBox[{"currentY", "=", "rootY"}], ";", "\[IndentingNewLine]", 
            RowBox[{"lineGraphics", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"circleGraphics", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"labelGraphics", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"bit", "=", 
                RowBox[{"path", "[", 
                 RowBox[{"[", "level", "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"nextX", "=", 
                RowBox[{
                 RowBox[{"baseXPositions", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"currentX", "-", 
                    RowBox[{"baseXPositions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", "0.3"}]}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"nextY", "=", 
                RowBox[{"yLevels", "[", 
                 RowBox[{"[", 
                  RowBox[{"level", "+", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"edgeColor", "=", 
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"bit", "==", "0"}], ",", "Blue", ",", 
                  RowBox[{"bit", "==", "1"}], ",", "Red", ",", "True", ",", 
                  "Black"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"lineGraphics", ",", 
                 RowBox[{"{", 
                  RowBox[{"edgeColor", ",", 
                   RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
                   RowBox[{"Arrowheads", "[", "0", "]"}], ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"currentX", ",", "currentY"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nextX", ",", "nextY"}], "}"}]}], "}"}], "]"}]}], 
                  "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"circleGraphics", ",", 
                 RowBox[{"{", 
                  RowBox[{"White", ",", 
                   RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "Thin"}], "}"}], "]"}], ",", 
                   RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"nextX", ",", "nextY"}], "}"}], ",", 
                    "nodeRadius"}], "]"}]}], "}"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"labelGraphics", ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"bit", ",", "Bold", ",", "12"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"nextX", ",", "nextY"}], "}"}]}], "]"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"currentX", "=", "nextX"}], ";", "\[IndentingNewLine]", 
               RowBox[{"currentY", "=", "nextY"}], ";"}], ",", 
              RowBox[{"{", 
               RowBox[{"level", ",", 
                RowBox[{"Length", "[", "path", "]"}]}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"leafY", "=", 
             RowBox[{"-", "3"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"leafX", "=", 
             RowBox[{"baseXPositions", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"leafColor", ",", "leafText"}], "}"}], "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"pathType", "==", "\"\<no-swap\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"LightGray", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "finalState", "]"}], ",", "Gray",
                     ",", "12"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<no-swap\>\"", ",", "Gray", ",", "10"}], 
                    "]"}]}], "}"}], ",", "Center", ",", 
                   RowBox[{"Spacings", "->", "0.1"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"pathType", "==", "\"\<accept\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"LightYellow", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "finalState", "]"}], ",", 
                    "Black", ",", "Bold", ",", "12"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<accept\>\"", ",", "Black", ",", "10"}], 
                    "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<P=\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"Simplify", "[", "probability", "]"}], "]"}], 
                    "]"}]}], ",", "Black", ",", "10"}], "]"}]}], "}"}], ",", 
                   "Center", ",", 
                   RowBox[{"Spacings", "->", "0.1"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"pathType", "==", "\"\<reject\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"LightYellow", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "finalState", "]"}], ",", 
                    "Black", ",", "Bold", ",", "12"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<reject\>\"", ",", "Black", ",", "10"}], 
                    "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<P=\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"Simplify", "[", "probability", "]"}], "]"}], 
                    "]"}]}], ",", "Black", ",", "10"}], "]"}]}], "}"}], ",", 
                   "Center", ",", 
                   RowBox[{"Spacings", "->", "0.1"}]}], "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"circleGraphics", ",", 
              RowBox[{"{", 
               RowBox[{"leafColor", ",", 
                RowBox[{"EdgeForm", "[", 
                 RowBox[{"{", 
                  RowBox[{"Black", ",", "Thin"}], "}"}], "]"}], ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"leafX", "-", "1.2"}], ",", 
                    RowBox[{"leafY", "-", "0.7"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"leafX", "+", "1.2"}], ",", 
                    RowBox[{"leafY", "+", "0.7"}]}], "}"}]}], "]"}]}], 
               "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"labelGraphics", ",", 
              RowBox[{"Text", "[", 
               RowBox[{"leafText", ",", 
                RowBox[{"{", 
                 RowBox[{"leafX", ",", "leafY"}], "}"}]}], "]"}]}], "]"}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "lineGraphics", ",", "circleGraphics", ",", "labelGraphics"}], 
             "}"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "tree", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rootGraphics", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LightBlue", ",", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Thick"}], "}"}], "]"}], ",", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rootX", ",", "rootY"}], "}"}], ",", 
             RowBox[{"nodeRadius", "*", "2"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<START\\n\>\"", "<>", 
              RowBox[{"ToString", "[", "initialState", "]"}]}], ",", "Bold", ",",
              "14"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"rootX", ",", "rootY"}], "}"}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Wrap", " ", "the", " ", "tree", " ", "in", " ", "a", " ", 
        "scrollable", " ", "pane"}], "*)"}], 
      RowBox[{"Pane", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pathGraphics", ",", "rootGraphics"}], "}"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "plotRangeX"}], ",", "plotRangeX"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "4"}], ",", 
               RowBox[{
                RowBox[{"yLevels", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "2"}]}], "}"}]}], 
            "}"}]}], ",", 
          RowBox[{"AspectRatio", "->", "0.4"}], ",", 
          RowBox[{"Background", "->", "White"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1800", ",", "600"}], "}"}], ",", 
        RowBox[{"Scrollbars", "->", "True"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"TRANSITION", " ", "MATRIX"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EnumerateTransitions", "[", "lattice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tree", "}"}], ",", 
     RowBox[{
      RowBox[{"tree", "=", 
       RowBox[{"EnumerateTree", "[", "lattice", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Merge", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lattice", ",", 
             RowBox[{"tree", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], "->", 
           RowBox[{"tree", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tree", "]"}]}], "}"}]}], "]"}], ",", 
        "Total"}], "]"}]}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildTransitionMatrixold", "[", "states_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "idx", ",", "M", ",", "trans"}], "}"}], ",", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "states", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"idx", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"states", "->", 
         RowBox[{"Range", "[", "n", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"trans", "=", 
          RowBox[{"EnumerateTransitions", "[", "s", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"KeyValueMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"idx", "[", 
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"idx", "[", 
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"Simplify", "[", "#2", "]"}]}], ")"}], "&"}], ",", 
           "trans"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "states"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "M"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildTransitionMatrix", "[", "states_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "idx", ",", "M", ",", "trans"}], "}"}], ",", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "states", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"idx", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"states", "->", 
         RowBox[{"Range", "[", "n", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"trans", "=", 
          RowBox[{"EnumerateTransitions", "[", "s", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"KeyValueMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"idx", "[", 
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"idx", "[", 
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}], "=",
               "#2"}], ")"}], "&"}], ",", 
           RowBox[{"(*", 
            RowBox[{"NO", " ", "Simplify"}], "*)"}], "trans"}], "]"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"s", ",", "states"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "M"}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"transitionMatrix", "=", 
    RowBox[{"BuildTransitionMatrix", "[", "states", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<\\nTransition matrix row sums: \>\"", ",", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Total", "[", 
      RowBox[{"transitionMatrix", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Transition matrix:\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "states", "]"}], "<=", "20"}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{"transitionMatrix", "//", "MatrixForm"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Showing 5x5 block:\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{"transitionMatrix", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "//", "MatrixForm"}], 
       "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DETAILED", " ", "BALANCE", " ", "CHECK"}], "-", "OPTIMIZED"}], 
   "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "Precompute", " ", "unnormalized", " ", "Boltzmann", " ", "weights", " ", 
    RowBox[{"(", 
     RowBox[{"Z", " ", "cancels", " ", "out"}], ")"}]}], "*)"}], 
  RowBox[{
   RowBox[{"boltzmannWeights", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "\[Beta]"}], "*", 
        RowBox[{"SymbolicEnergy", "[", 
         RowBox[{"states", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Print", "[", "\"\<Computing detailed balance violations...\>\"", "]"}], 
   ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Compute", " ", "violations", " ", "without", " ", "Z", " ", "factor"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"violations", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"boltzmannWeights", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"transitionMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"boltzmannWeights", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"transitionMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}], ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Remove", " ", "literal", " ", "zeros"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nonZero", "=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"violations", ",", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Non-literal-zero violations: \>\"", ",", 
     RowBox[{"Length", "[", "nonZero", "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Remove", " ", "duplicates", " ", "before", " ", "simplifying"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uniqueViolations", "=", 
    RowBox[{"DeleteDuplicates", "[", "nonZero", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Unique violations to simplify: \>\"", ",", 
     RowBox[{"Length", "[", "uniqueViolations", "]"}], 
     ",", "\"\< (reduced from \>\"", ",", 
     RowBox[{"Length", "[", "nonZero", "]"}], ",", "\"\<)\>\""}], "]"}], 
   ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Simplify", " ", "only", " ", "unique", " ", "violations"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "uniqueViolations", "]"}], ">", "0"}], ",", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Applying FullSimplify to unique violations...\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"simplifiedUnique", "=", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{"FullSimplify", ",", "uniqueViolations"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Count", " ", "remaining", " ", "violations"}], "*)"}], 
      RowBox[{"remainingViolations", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"simplifiedUnique", ",", 
         RowBox[{
          RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\\nDetailed balance: \>\"", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "remainingViolations", "]"}], "==", "0"}], 
          ",", "\"\<SATISFIED (all unique violations symbolically reduced to \
0)\>\"", ",", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "remainingViolations", "]"}], "]"}], 
           "<>", "\"\< unique violations remain after FullSimplify\>\""}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Show", " ", "remaining", " ", "violations", " ", "if", " ", "small", " ",
         "enough"}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "remainingViolations", "]"}], ">", "0"}], "&&", 
         RowBox[{
          RowBox[{"Length", "[", "remainingViolations", "]"}], "<=", "3"}]}], 
        ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Remaining violations: \>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"remainingViolations", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "remainingViolations", "]"}]}], "}"}]}], 
          "]"}]}]}], "]"}], ";"}], ",", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<\\nDetailed balance: SATISFIED (all violations are \
literal zeros)\>\"", "]"}], ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "OLD", " ", "DB", " ", "CHECK", " ", "which", " ", "is", " ", "slower", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
         "===", "===", "=="}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"DETAILED", " ", "BALANCE", " ", "CHECK"}], "\[LongDash]", 
        RowBox[{"fixed", " ", "FullSimplify", " ", "logic"}]}], "*)"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
         "===", "===", "=="}], "*)"}], "theoreticalDist"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "\[Beta]"}], "*", 
         RowBox[{"SymbolicEnergy", "[", 
          RowBox[{"states", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\n", 
    RowBox[{"Z", "=", 
     RowBox[{"Total", "[", "theoreticalDist", "]"}]}], ";", "\n", 
    RowBox[{"theoreticalDist", "=", 
     RowBox[{"theoreticalDist", "/", "Z"}]}], ";", "\[IndentingNewLine]", 
    "\n", 
    RowBox[{"violations", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"theoreticalDist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"transitionMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"theoreticalDist", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"transitionMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "states", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", 
          RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}], "]"}]}], ";",
     "\[IndentingNewLine]", "\n", 
    RowBox[{"(*", 
     RowBox[{"Remove", " ", "literal", " ", "zeros"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"nonZero", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"violations", ",", "0"}], "]"}]}], ";", "\n", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Attempt", " ", "simplification", " ", "if", " ", "necessary"}], 
     "*)"}], 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "nonZero", "]"}], ">", "0"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "fsTest", "}"}], ",", 
        RowBox[{
         RowBox[{"fsTest", "=", 
          RowBox[{"Quiet", "[", 
           RowBox[{"Check", "[", 
            RowBox[{
             RowBox[{"FullSimplify", "[", 
              RowBox[{"nonZero", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<FAIL\>\""}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Use", " ", "symbolic", " ", "comparison", " ", "to", " ", "0"}], 
          "*)"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fsTest", "=!=", "\"\<FAIL\>\""}], "&&", 
            RowBox[{"fsTest", "===", "0"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "FullSimplify", " ", "all", " ", "violations", " ", "in", " ", 
             "parallel"}], "*)"}], 
           RowBox[{
            RowBox[{"nonZero", "=", 
             RowBox[{"ParallelMap", "[", 
              RowBox[{"FullSimplify", ",", "nonZero"}], "]"}]}], ";"}]}], 
          "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\n", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\\nDetailed balance: \>\"", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"nonZero", ",", 
            RowBox[{
             RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}], "]"}], "==", "0"}], 
        ",", "\"\<SATISFIED\>\"", ",", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"nonZero", ",", 
             RowBox[{
              RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}], "]"}], "]"}], 
         "<>", "\"\< violations\>\""}]}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "   ", 
    RowBox[{
     RowBox[{"OLD", " ", "CODE"}], ",", " ", 
     RowBox[{
      RowBox[{
      "USES", " ", "A", " ", "NUMERICAL", " ", "TEST", "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{
        "Attempt", " ", "simplification", " ", "if", " ", "necessary"}], 
        "*)"}], "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "nonZero", "]"}], ">", "0"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "fsTest", "}"}], ",", 
           RowBox[{
            RowBox[{"fsTest", "=", 
             RowBox[{"Quiet", "[", 
              RowBox[{"Check", "[", 
               RowBox[{
                RowBox[{"FullSimplify", "[", 
                 RowBox[{"nonZero", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], 
                ",", "\"\<FAIL\>\""}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "Use", " ", "PossibleZeroQ", " ", "instead", " ", "of"}], "===",
               "0"}], "*)"}], 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"fsTest", "=!=", "\"\<FAIL\>\""}], "&&", 
               RowBox[{"PossibleZeroQ", "[", "fsTest", "]"}]}], ",", 
              RowBox[{"(*", 
               RowBox[{
               "FullSimplify", " ", "all", " ", "violations", " ", "in", " ", 
                "parallel"}], "*)"}], 
              RowBox[{
               RowBox[{"nonZero", "=", 
                RowBox[{"ParallelMap", "[", 
                 RowBox[{"FullSimplify", ",", "nonZero"}], "]"}]}], ";"}]}], 
             "]"}]}]}], "]"}]}], "]"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\\nDetailed balance: \>\"", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"nonZero", ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"PossibleZeroQ", "[", "#", "]"}]}], "&"}]}], "]"}], 
            "]"}], "==", "0"}], ",", "\"\<SATISFIED\>\"", ",", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"nonZero", ",", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"PossibleZeroQ", "[", "#", "]"}]}], "&"}]}], "]"}], 
             "]"}], "]"}], "<>", "\"\< violations\>\""}]}], "]"}]}], "]"}], 
      ";"}]}], "*)"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "VISUALIZE", " ", "TREES", " ", "FOR", " ", "FIRST", " ", "TWO", " ", 
    "STATES"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<\\nDecision tree for first state:\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tree1", "=", 
   RowBox[{"VisualizeDecisionTree", "[", 
    RowBox[{"states", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "tree1", "]"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "states", "]"}], ">", "1"}], ",", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<\\nDecision tree for second state:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tree2", "=", 
      RowBox[{"VisualizeDecisionTree", "[", 
       RowBox[{"states", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "tree2", "]"}], ";"}]}], "]"}], 
  ";"}], "\n"}], "Input",
 CellChangeTimes->{
  3.978026039786974*^9, {3.978026076343*^9, 3.97802609128259*^9}, {
   3.978026339779911*^9, 3.9780263886931334`*^9}, {3.978026697603706*^9, 
   3.9780266993765373`*^9}, {3.9780267932783403`*^9, 
   3.9780267935907793`*^9}, {3.978026861858182*^9, 3.978026862248084*^9}, {
   3.9780269026905203`*^9, 3.978026926709798*^9}, {3.9780272325276423`*^9, 
   3.978027240814918*^9}, {3.978027517517367*^9, 3.978027528534594*^9}, {
   3.9780278115345583`*^9, 3.978027813159099*^9}, {3.978027876484991*^9, 
   3.978027889116269*^9}, {3.978027942420396*^9, 3.978027944284896*^9}, {
   3.978027996296674*^9, 3.978028003210821*^9}, {3.978030720515004*^9, 
   3.978030729710657*^9}, {3.978030839456015*^9, 3.978030857300007*^9}, {
   3.97803096772178*^9, 3.978031015079197*^9}, {3.978031055997868*^9, 
   3.978031059357966*^9}, {3.978031143326894*^9, 3.978031147263369*^9}, {
   3.978031198231415*^9, 3.9780311994463453`*^9}, {3.978031254679739*^9, 
   3.978031255064951*^9}, {3.978031394330769*^9, 3.9780313944474783`*^9}, {
   3.978031521598961*^9, 3.978031525019001*^9}},
 CellLabel->
  "In[3496]:=",ExpressionUUID->"3f8050e8-6e84-43e9-98ef-ffdaef135efa"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"L = \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["L = ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.9780315257290907`*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"43060ceb-1278-4137-be6f-04b1fa8f9407"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nParticles = \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["nParticles = ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525732498*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"c0c54438-110d-430a-b100-d7556e647d54"],

Cell[BoxData["\<\"J Matrix:\"\>"], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.9780315257339287`*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"a1c19a56-1511-4dfd-9b9a-40902c6748a9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "J01", "J02", "J03"},
     {"J01", "0", "J12", "J13"},
     {"J02", "J12", "0", "J23"},
     {"J03", "J13", "J23", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525735292*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"1cc54889-8423-4ad0-997a-981c8eca03f3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total configurations: \"\>", "\[InvisibleSpace]", "24"}],
  SequenceForm["Total configurations: ", 24],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525736527*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"7b5eb673-73e9-48af-8e03-3dd9b5f6fd95"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"First few: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "2", ",", "0"}], "}"}]}], "}"}]}],
  SequenceForm[
  "First few: ", {{1, 2, 3, 0}, {1, 3, 2, 0}, {2, 1, 3, 0}, {2, 3, 1, 0}, {3, 
   1, 2, 0}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525737749*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"6e568e67-492f-49bb-8f9c-ec4f8786cd28"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\nTransition matrix row sums: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
      ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",",
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     "1", ",", "1"}], "}"}]}],
  SequenceForm[
  "\nTransition matrix row sums: ", {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525774757*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"0597bd77-32d6-4cc6-9bcd-6bfab8ddc17b"],

Cell[BoxData["\<\"Transition matrix:\"\>"], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.9780315257758713`*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"af0f77a0-4650-4fd3-80fe-1684207c5d22"],

Cell[BoxData["\<\"Showing 5x5 block:\"\>"], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.9780315257768993`*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"448962c0-1b41-4d0c-a782-af3bd91e823d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{"J12", "-", "J13"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"J12", "-", "J13"}], ")"}], " ", "\[Beta]"}], 
                    ")"}]}]], 
                  RowBox[{
                   RowBox[{"J12", "-", "J13"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J13"}], "+", "J23"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J13"}], "+", "J23"}], ")"}], " ", 
                    "\[Beta]"}], ")"}]}]], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J13"}], "+", "J23"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"J12", "-", "J13"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"J12", "-", "J13"}], ")"}], " ", "\[Beta]"}], 
                  ")"}]}]], 
               RowBox[{
                RowBox[{"J12", "-", "J13"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "J13"}], "+", "J23"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J13"}], "+", "J23"}], ")"}], " ", 
                   "\[Beta]"}], ")"}]}]], 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "J13"}], "+", "J23"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0"},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "J12"}], "+", "J13"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J12"}], "+", "J13"}], ")"}], " ", 
                   "\[Beta]"}], ")"}]}]], 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "J12"}], "+", "J13"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J12"}], "+", "J13"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J12"}], "+", "J13"}], ")"}], " ", 
                    "\[Beta]"}], ")"}]}]], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J12"}], "+", "J13"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J12"}], "+", "J23"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J12"}], "+", "J23"}], ")"}], " ", 
                    "\[Beta]"}], ")"}]}]], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J12"}], "+", "J23"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "J12"}], "+", "J23"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J12"}], "+", "J23"}], ")"}], " ", 
                   "\[Beta]"}], ")"}]}]], 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "J12"}], "+", "J23"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"J13", "-", "J23"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"J13", "-", "J23"}], ")"}], " ", "\[Beta]"}], 
                  ")"}]}]], 
               RowBox[{
                RowBox[{"J13", "-", "J23"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{"J12", "-", "J23"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"J12", "-", "J23"}], ")"}], " ", "\[Beta]"}], 
                    ")"}]}]], 
                  RowBox[{
                   RowBox[{"J12", "-", "J23"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{"J13", "-", "J23"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"J13", "-", "J23"}], ")"}], " ", "\[Beta]"}], 
                    ")"}]}]], 
                  RowBox[{
                   RowBox[{"J13", "-", "J23"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"J12", "-", "J23"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"J12", "-", "J23"}], ")"}], " ", "\[Beta]"}], 
                  ")"}]}]], 
               RowBox[{
                RowBox[{"J12", "-", "J23"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0"},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "J12"}], "+", "J23"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J12"}], "+", "J23"}], ")"}], " ", 
                   "\[Beta]"}], ")"}]}]], 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "J12"}], "+", "J23"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J12"}], "+", "J13"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J12"}], "+", "J13"}], ")"}], " ", 
                    "\[Beta]"}], ")"}]}]], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J12"}], "+", "J13"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J12"}], "+", "J23"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J12"}], "+", "J23"}], ")"}], " ", 
                    "\[Beta]"}], ")"}]}]], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "J12"}], "+", "J23"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"1", 
               RowBox[{
                RowBox[{"J12", "-", "J23"}], "\[LessEqual]", "0"}]},
              {
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"J12", "-", "J23"}], ")"}], " ", "\[Beta]"}], 
                  ")"}]}]], 
               RowBox[{
                RowBox[{"J12", "-", "J23"}], ">", "0"}]},
              {"0", 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->True]}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}},
             Selectable->True]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ")"}]}], "0", "0", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{"J12", "-", "J23"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"J12", "-", "J23"}], ")"}], " ", "\[Beta]"}], 
                    ")"}]}]], 
                  RowBox[{
                   RowBox[{"J12", "-", "J23"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           TagBox[GridBox[{
              {"\[Piecewise]", GridBox[{
                 {"1", 
                  RowBox[{
                   RowBox[{"J13", "-", "J23"}], "\[LessEqual]", "0"}]},
                 {
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"J13", "-", "J23"}], ")"}], " ", "\[Beta]"}], 
                    ")"}]}]], 
                  RowBox[{
                   RowBox[{"J13", "-", "J23"}], ">", "0"}]},
                 {"0", 
                  TagBox["True",
                   "PiecewiseDefault",
                   AutoDelete->True]}
                },
                AllowedDimensions->{2, Automatic},
                Editable->True,
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}},
                Selectable->True]}
             },
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.35]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            "Piecewise",
            DeleteWithContents->True,
            Editable->False,
            SelectWithContents->True,
            Selectable->False,
            StripWrapperBoxes->True], ")"}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525782509*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"af67b837-13f9-4b8e-b4ae-c396ef82467d"],

Cell[BoxData["\<\"Computing detailed balance violations...\"\>"], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525785931*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"cbf7e8da-4d52-47a7-9c88-72c4eb181709"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Non-literal-zero violations: \"\>", "\[InvisibleSpace]", "48"}],
  SequenceForm["Non-literal-zero violations: ", 48],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525786928*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"d0da1b36-8909-4b1a-af84-425bd7ac001a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Unique violations to simplify: \"\>", "\[InvisibleSpace]", "6",
    "\[InvisibleSpace]", "\<\" (reduced from \"\>", "\[InvisibleSpace]", "48",
    "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm[
  "Unique violations to simplify: ", 6, " (reduced from ", 48, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525787796*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"6320f8ee-e2dc-4a54-b5b2-7e160a984f88"],

Cell[BoxData["\<\"Applying FullSimplify to unique violations...\"\>"], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.9780315257886343`*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"7a070ca7-7005-47f1-a08b-d8d164fb6b33"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\nDetailed balance: \"\>", 
   "\[InvisibleSpace]", "\<\"SATISFIED (all unique violations symbolically \
reduced to 0)\"\>"}],
  SequenceForm[
  "\nDetailed balance: ", 
   "SATISFIED (all unique violations symbolically reduced to 0)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031525974599*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"62f22f3c-7fa3-474d-bcd5-48b462dc82b7"],

Cell[BoxData["\<\"\\nDecision tree for first state:\"\>"], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.9780315259760923`*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"a8636527-141c-416b-997f-9d9c555ca5c0"],

Cell[BoxData[
 PaneBox[
  GraphicsBox[{{{{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-32.666666666666664`, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-32.666666666666664`, 2}, {-42.46666666666666, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-32.666666666666664`, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-42.46666666666666, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-47.86666666666667, -3.7}, \
{-45.46666666666666, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-32.666666666666664, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-42.46666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{2, 1, 3, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J23\\\", \\\"\[LessEqual]\\\", \\\"J13\\\
\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"J13\\\", \\\"-\\\", \\\"J23\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Beta]\\\"}]], RowBox[{\\\"J23\\\", \\\">\\\", \\\"J13\\\"}]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-46.666666666666664, -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-23.33333333333333, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-23.33333333333333, 2}, {-30.33333333333333, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-23.33333333333333, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-30.33333333333333, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-34.53333333333333, -3.7}, \
{-32.133333333333326, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-23.33333333333333, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-30.33333333333333, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 3, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J23\\\", \\\"\[LessEqual]\\\", \
\\\"J13\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"J13\\\", \\\"-\\\", \\\"J23\\\"}], \
\\\")\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], RowBox[{\\\"J23\\\", \\\">\\\", \
\\\"J13\\\"}]}}, Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, \
1.2`], Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, \
Automatic]], Rule[Selectable, True], Rule[Editable, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 0.5`], \
Rule[ColumnWidths, Automatic]], \\\"Piecewise\\\", Rule[SyntaxForm, Equal], \
Rule[SelectWithContents, True], Rule[StripWrapperBoxes, True], \
Rule[Selectable, False], Rule[Editable, False], Rule[DeleteWithContents, \
True]], \\\")\\\"}]}], \\\")\\\"}]}], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-33.33333333333333, -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-14., 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-14., 2}, {-18.2, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-14., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-18.2, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-21.2, -3.7}, {-18.8, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-14., 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-18.2, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 3, 2, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \\\"J13\\\
\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"J13\\\", \\\"-\\\", \\\"J12\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Beta]\\\"}]], RowBox[{\\\"J12\\\", \\\">\\\", \\\"J13\\\"}]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-20., -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-4.666666666666666, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-4.666666666666666, 2}, {-6.066666666666666, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-4.666666666666666, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-6.066666666666666, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-7.866666666666666, -3.7}, \
{-5.466666666666666, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-4.666666666666666, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-6.066666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 3, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \
\\\"J13\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"J13\\\", \\\"-\\\", \\\"J12\\\"}], \
\\\")\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], RowBox[{\\\"J12\\\", \\\">\\\", \
\\\"J13\\\"}]}}, Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, \
1.2`], Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, \
Automatic]], Rule[Selectable, True], Rule[Editable, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 0.5`], \
Rule[ColumnWidths, Automatic]], \\\"Piecewise\\\", Rule[SyntaxForm, Equal], \
Rule[SelectWithContents, True], Rule[StripWrapperBoxes, True], \
Rule[Selectable, False], Rule[Editable, False], Rule[DeleteWithContents, \
True]], \\\")\\\"}]}], \\\")\\\"}]}], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-6.666666666666666, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {4.666666666666666, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{4.666666666666666, 2}, {6.066666666666666, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{4.666666666666666, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{6.066666666666666, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{5.466666666666666, -3.7}, {7.866666666666666, -2.3}]}}, \
{InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {4.666666666666666, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {6.066666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 0, 3}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J23\\\", \\\"\[LessEqual]\\\", \\\"J13\\\
\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"J13\\\", \\\"-\\\", \\\"J23\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Beta]\\\"}]], RowBox[{\\\"J23\\\", \\\">\\\", \\\"J13\\\"}]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {6.666666666666666, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {14., 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{14., 2}, {18.2, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{14., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{18.2, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{18.8, -3.7}, {21.2, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {14., 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {18.2, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 3, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J23\\\", \\\"\[LessEqual]\\\", \
\\\"J13\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"J13\\\", \\\"-\\\", \\\"J23\\\"}], \
\\\")\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], RowBox[{\\\"J23\\\", \\\">\\\", \
\\\"J13\\\"}]}}, Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, \
1.2`], Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, \
Automatic]], Rule[Selectable, True], Rule[Editable, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 0.5`], \
Rule[ColumnWidths, Automatic]], \\\"Piecewise\\\", Rule[SyntaxForm, Equal], \
Rule[SelectWithContents, True], Rule[StripWrapperBoxes, True], \
Rule[Selectable, False], Rule[Editable, False], Rule[DeleteWithContents, \
True]], \\\")\\\"}]}], \\\")\\\"}]}], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {20., -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {23.33333333333333, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{23.33333333333333, 2}, {30.33333333333333, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{23.33333333333333, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{30.33333333333333, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{32.133333333333326, -3.7}, \
{34.53333333333333, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {23.33333333333333, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {30.33333333333333, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{0, 2, 3, 1}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \\\"J13\\\
\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"J13\\\", \\\"-\\\", \\\"J12\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Beta]\\\"}]], RowBox[{\\\"J12\\\", \\\">\\\", \\\"J13\\\"}]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {33.33333333333333, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {32.666666666666664`, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{32.666666666666664`, 2}, {42.46666666666666, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{32.666666666666664`, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{42.46666666666666, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{45.46666666666666, -3.7}, {47.86666666666667, -2.3}]}}, \
{InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {32.666666666666664, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {42.46666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 3, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J12\\\", \\\"\[LessEqual]\\\", \
\\\"J13\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"J13\\\", \\\"-\\\", \\\"J12\\\"}], \
\\\")\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], RowBox[{\\\"J12\\\", \\\">\\\", \
\\\"J13\\\"}]}}, Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, \
1.2`], Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, \
Automatic]], Rule[Selectable, True], Rule[Editable, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 0.5`], \
Rule[ColumnWidths, Automatic]], \\\"Piecewise\\\", Rule[SyntaxForm, Equal], \
Rule[SelectWithContents, True], Rule[StripWrapperBoxes, True], \
Rule[Selectable, False], Rule[Editable, False], Rule[DeleteWithContents, \
True]], \\\")\\\"}]}], \\\")\\\"}]}], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {46.666666666666664, -3}]}}}, {
     {RGBColor[0.87, 0.94, 1], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
      DiskBox[{0, 4}, 0.4]}, InsetBox[
      StyleBox["\<\"START\\n{1, 2, 3, 0}\"\>",
       StripOnInput->False,
       FontSize->14,
       FontWeight->Bold], {0, 4}]}},
   AspectRatio->0.4,
   Background->GrayLevel[1],
   PlotRange->{{-50, 50}, {-4, 6}}],
  ImageSize->{1800, 600},
  Scrollbars->True]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.9780315260441523`*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"de632962-8360-4f13-9c92-ce9ebc9414e4"],

Cell[BoxData["\<\"\\nDecision tree for second state:\"\>"], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.9780315260611486`*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"aca1bb1f-4b31-4c35-822d-b2a0c77cfeb0"],

Cell[BoxData[
 PaneBox[
  GraphicsBox[{{{{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-32.666666666666664`, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-32.666666666666664`, 2}, {-42.46666666666666, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-32.666666666666664`, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-42.46666666666666, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-47.86666666666667, -3.7}, \
{-45.46666666666666, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-32.666666666666664, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-42.46666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{3, 1, 2, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J23\\\", \\\"\[LessEqual]\\\", \\\"J12\\\
\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"J12\\\", \\\"-\\\", \\\"J23\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Beta]\\\"}]], RowBox[{\\\"J23\\\", \\\">\\\", \\\"J12\\\"}]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-46.666666666666664, -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-23.33333333333333, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-23.33333333333333, 2}, {-30.33333333333333, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-23.33333333333333, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-30.33333333333333, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-34.53333333333333, -3.7}, \
{-32.133333333333326, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-23.33333333333333, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-30.33333333333333, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 3, 2, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J23\\\", \\\"\[LessEqual]\\\", \
\\\"J12\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"J12\\\", \\\"-\\\", \\\"J23\\\"}], \
\\\")\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], RowBox[{\\\"J23\\\", \\\">\\\", \
\\\"J12\\\"}]}}, Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, \
1.2`], Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, \
Automatic]], Rule[Selectable, True], Rule[Editable, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 0.5`], \
Rule[ColumnWidths, Automatic]], \\\"Piecewise\\\", Rule[SyntaxForm, Equal], \
Rule[SelectWithContents, True], Rule[StripWrapperBoxes, True], \
Rule[Selectable, False], Rule[Editable, False], Rule[DeleteWithContents, \
True]], \\\")\\\"}]}], \\\")\\\"}]}], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-33.33333333333333, -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-14., 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-14., 2}, {-18.2, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-14., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-18.2, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-21.2, -3.7}, {-18.8, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-14., 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-18.2, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 2, 3, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J13\\\", \\\"\[LessEqual]\\\", \\\"J12\\\
\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"J12\\\", \\\"-\\\", \\\"J13\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Beta]\\\"}]], RowBox[{\\\"J13\\\", \\\">\\\", \\\"J12\\\"}]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-20., -3}]}}, {{
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {-4.666666666666666, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{-4.666666666666666, 2}, {-6.066666666666666, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-4.666666666666666, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{-6.066666666666666, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{-7.866666666666666, -3.7}, \
{-5.466666666666666, -2.3}]}}, {InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-4.666666666666666, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {-6.066666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 3, 2, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J13\\\", \\\"\[LessEqual]\\\", \
\\\"J12\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"J12\\\", \\\"-\\\", \\\"J13\\\"}], \
\\\")\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], RowBox[{\\\"J13\\\", \\\">\\\", \
\\\"J12\\\"}]}}, Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, \
1.2`], Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, \
Automatic]], Rule[Selectable, True], Rule[Editable, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 0.5`], \
Rule[ColumnWidths, Automatic]], \\\"Piecewise\\\", Rule[SyntaxForm, Equal], \
Rule[SelectWithContents, True], Rule[StripWrapperBoxes, True], \
Rule[Selectable, False], Rule[Editable, False], Rule[DeleteWithContents, \
True]], \\\")\\\"}]}], \\\")\\\"}]}], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {-6.666666666666666, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {4.666666666666666, 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{4.666666666666666, 2}, {6.066666666666666, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{4.666666666666666, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{6.066666666666666, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{5.466666666666666, -3.7}, {7.866666666666666, -2.3}]}}, \
{InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {4.666666666666666, 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {6.066666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 3, 0, 2}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J23\\\", \\\"\[LessEqual]\\\", \\\"J12\\\
\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"J12\\\", \\\"-\\\", \\\"J23\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Beta]\\\"}]], RowBox[{\\\"J23\\\", \\\">\\\", \\\"J12\\\"}]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {6.666666666666666, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {14., 2}}]}, 
       {RGBColor[0, 0, 1], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{14., 2}, {18.2, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{14., 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{18.2, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{18.8, -3.7}, {21.2, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {14., 2}], InsetBox[
        StyleBox["0",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {18.2, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 3, 2, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J23\\\", \\\"\[LessEqual]\\\", \
\\\"J12\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"J12\\\", \\\"-\\\", \\\"J23\\\"}], \
\\\")\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], RowBox[{\\\"J23\\\", \\\">\\\", \
\\\"J12\\\"}]}}, Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, \
1.2`], Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, \
Automatic]], Rule[Selectable, True], Rule[Editable, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 0.5`], \
Rule[ColumnWidths, Automatic]], \\\"Piecewise\\\", Rule[SyntaxForm, Equal], \
Rule[SelectWithContents, True], Rule[StripWrapperBoxes, True], \
Rule[Selectable, False], Rule[Editable, False], Rule[DeleteWithContents, \
True]], \\\")\\\"}]}], \\\")\\\"}]}], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {20., -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {23.33333333333333, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{23.33333333333333, 2}, {30.33333333333333, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{23.33333333333333, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{30.33333333333333, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{32.133333333333326, -3.7}, \
{34.53333333333333, -2.3}]}}, {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {23.33333333333333, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {30.33333333333333, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{0, 3, 2, 1}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"accept\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\
\", GridBox[{{\\\"1\\\", RowBox[{\\\"J13\\\", \\\"\[LessEqual]\\\", \\\"J12\\\
\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"J12\\\", \\\"-\\\", \\\"J13\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Beta]\\\"}]], RowBox[{\\\"J13\\\", \\\">\\\", \\\"J12\\\"}]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 1.2`], \
Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, Automatic]], \
Rule[Selectable, True], Rule[Editable, True]]}}, Rule[ColumnAlignments, \
List[Left]], Rule[ColumnSpacings, 0.5`], Rule[ColumnWidths, Automatic]], \
\\\"Piecewise\\\", Rule[SyntaxForm, Equal], Rule[SelectWithContents, True], \
Rule[StripWrapperBoxes, True], Rule[Selectable, False], Rule[Editable, \
False], Rule[DeleteWithContents, True]], \\\")\\\"}]}], TraditionalForm]\\)\"\
\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {33.33333333333333, -3}]}}, {{
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{0, 4}, {32.666666666666664`, 2}}]}, 
       {RGBColor[1, 0, 0], Thickness[0.0025], Arrowheads[0], 
        ArrowBox[{{32.666666666666664`, 2}, {42.46666666666666, 0}}]}}, {
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{32.666666666666664`, 2}, 0.2]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        DiskBox[{42.46666666666666, 0}, 0.2]}, 
       {RGBColor[1, 1, 0.85], EdgeForm[{GrayLevel[0], Thickness[Tiny]}], 
        RectangleBox[{45.46666666666666, -3.7}, {47.86666666666667, -2.3}]}}, \
{InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {32.666666666666664, 2}], InsetBox[
        StyleBox["1",
         StripOnInput->False,
         FontSize->12,
         FontWeight->Bold], {42.46666666666666, 0}], InsetBox[
        TagBox[GridBox[{
           {
            StyleBox["\<\"{1, 3, 2, 0}\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontWeight->Bold,
             FontColor->GrayLevel[0]]},
           {
            StyleBox["\<\"reject\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]},
           {
            
            StyleBox["\<\"P=\\!\\(\\*FormBox[RowBox[{FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \
RowBox[{\\\"(\\\", TagBox[GridBox[{{\\\"\[Piecewise]\\\", \
GridBox[{{\\\"1\\\", RowBox[{\\\"J13\\\", \\\"\[LessEqual]\\\", \
\\\"J12\\\"}]}, {SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"J12\\\", \\\"-\\\", \\\"J13\\\"}], \
\\\")\\\"}], \\\" \\\", \\\"\[Beta]\\\"}]], RowBox[{\\\"J13\\\", \\\">\\\", \
\\\"J12\\\"}]}}, Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, \
1.2`], Rule[ColumnWidths, Automatic], Rule[AllowedDimensions, List[2, \
Automatic]], Rule[Selectable, True], Rule[Editable, True]]}}, \
Rule[ColumnAlignments, List[Left]], Rule[ColumnSpacings, 0.5`], \
Rule[ColumnWidths, Automatic]], \\\"Piecewise\\\", Rule[SyntaxForm, Equal], \
Rule[SelectWithContents, True], Rule[StripWrapperBoxes, True], \
Rule[Selectable, False], Rule[Editable, False], Rule[DeleteWithContents, \
True]], \\\")\\\"}]}], \\\")\\\"}]}], TraditionalForm]\\)\"\>",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->10,
             FontColor->GrayLevel[0]]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Center}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0.1}}}],
         "Column"], {46.666666666666664, -3}]}}}, {
     {RGBColor[0.87, 0.94, 1], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
      DiskBox[{0, 4}, 0.4]}, InsetBox[
      StyleBox["\<\"START\\n{1, 3, 2, 0}\"\>",
       StripOnInput->False,
       FontSize->14,
       FontWeight->Bold], {0, 4}]}},
   AspectRatio->0.4,
   Background->GrayLevel[1],
   PlotRange->{{-50, 50}, {-4, 6}}],
  ImageSize->{1800, 600},
  Scrollbars->True]], "Print",
 CellChangeTimes->{
  3.978026044355239*^9, {3.9780260767590427`*^9, 3.9780260917812767`*^9}, {
   3.978026370303626*^9, 3.978026389121855*^9}, 3.978026700904098*^9, 
   3.978026794158205*^9, 3.978026862620813*^9, {3.9780269033726187`*^9, 
   3.9780269275080442`*^9}, 3.978027242631858*^9, {3.9780275187567*^9, 
   3.9780275289202557`*^9}, 3.9780278139437037`*^9, 3.9780278896589117`*^9, 
   3.978028003769642*^9, 3.97803042146564*^9, 3.978030731318557*^9, 
   3.978030774341133*^9, 3.978030840139049*^9, {3.978030995358604*^9, 
   3.9780310016673594`*^9}, 3.9780310601648197`*^9, 3.978031147592558*^9, 
   3.9780312006720552`*^9, 3.9780312556588793`*^9, 3.978031395012024*^9, 
   3.978031526109435*^9},
 CellLabel->
  "During evaluation of \
In[3496]:=",ExpressionUUID->"5d506d47-2432-4cb2-8986-cce8bac59ce8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"NUMERICAL", " ", "SIMULATION"}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "random", " ", "symmetric", " ", "J", " ", "matrix"}], 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"GenerateRandomJMatrix", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "J", "}"}], ",", 
      RowBox[{
       RowBox[{"J", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"n", "+", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "<", "j"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
             RowBox[{"J", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "J"}]}], "]"}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Set", " ", "numerical", " ", "values"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SeedRandom", "[", "1", "]"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "for", " ", "reproducibility", " ", "of", " ", "J", " ", "matrix"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"JMatrixNum", "=", 
     RowBox[{"GenerateRandomJMatrix", "[", "nParticles", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Beta]Num", "=", "1.0"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Numerical J Matrix:\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"JMatrixNum", "//", "MatrixForm"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "numerical", " ", "energy", " ", "function"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"NumericalEnergy", "[", "lattice_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"E", "=", "0"}], ",", "i", ",", "j"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "==", 
              RowBox[{"Length", "[", "lattice", "]"}]}], ",", "1", ",", 
             RowBox[{"i", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"lattice", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "!=", "0"}], "&&", 
             RowBox[{
              RowBox[{"lattice", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "!=", "0"}]}], ",", 
            RowBox[{"E", "-=", 
             RowBox[{"JMatrixNum", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"lattice", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
                RowBox[{
                 RowBox[{"lattice", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
              "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "lattice", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "E"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Replace", " ", "symbolic", " ", "J", " ", "and", " ", "\[Beta]", " ", 
     "with", " ", "numerical", " ", "values", " ", "for", " ", "MCMC"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"JMatrix", "=", "JMatrixNum"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Beta]", "=", "\[Beta]Num"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Initial", " ", "state"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"currentState", "=", 
     RowBox[{"states", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Number", " ", "of", " ", "iterations"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"nSteps", "=", "50000"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Run", " ", "simulation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SeedRandom", "[", "12", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"trajectory", "=", 
     RowBox[{"NestList", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"lattice", ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nBits", ",", "bits", ",", "result"}], "}"}], ",", 
           RowBox[{
            RowBox[{"nBits", "=", 
             RowBox[{"Ceiling", "[", 
              RowBox[{"Log2", "[", 
               RowBox[{"Length", "[", "lattice", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"bits", "=", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", "nBits"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"$BinaryChoices", "=", "bits"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"$BinaryIndex", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"result", "=", 
             RowBox[{"KawasakiMoveFromBits", "[", "lattice", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "result", "]"}], 
               "===", "\"\<no-swap\>\""}], ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RandomReal", "[", "]"}], "<", 
                 RowBox[{"result", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
                RowBox[{"result", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"result", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}]}]}],
           "]"}]}], "]"}], ",", "currentState", ",", "nSteps"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Print", " ", "first", " ", "few", " ", "states"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<First 10 states:\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Take", "[", 
      RowBox[{"trajectory", ",", "10"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Count", " ", "state", " ", "frequencies"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stateCounts", "=", 
     RowBox[{"Counts", "[", "trajectory", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\nState frequencies:\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"stateCounts", "//", "Normal"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{3.9780264509441147`*^9, 3.9780268057002687`*^9},
 CellLabel->
  "In[3537]:=",ExpressionUUID->"f017be70-9962-4837-aeec-177be8cb1f9b"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Numerical J Matrix:\"\>"], "Print",
 CellChangeTimes->{
  3.978026451688295*^9, 3.978026808198977*^9, 3.978026868670436*^9, {
   3.9780269093669*^9, 3.9780269354162207`*^9}, 3.978027280670052*^9, 
   3.978027663780684*^9, 3.978030426310503*^9, 3.978031158785578*^9, 
   3.978031332864462*^9, 3.9780315353210897`*^9},
 CellLabel->
  "During evaluation of \
In[3537]:=",ExpressionUUID->"c462d7a6-fe56-4933-9286-64363760dccb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0.6347789803421424`", 
      RowBox[{"-", "0.7771607777375271`"}], "0.5790519892677031`"},
     {"0.6347789803421424`", "0", 
      RowBox[{"-", "0.6243937065879472`"}], 
      RowBox[{"-", "0.5172780650846991`"}]},
     {
      RowBox[{"-", "0.7771607777375271`"}], 
      RowBox[{"-", "0.6243937065879472`"}], "0", 
      RowBox[{"-", "0.8685224809824379`"}]},
     {"0.5790519892677031`", 
      RowBox[{"-", "0.5172780650846991`"}], 
      RowBox[{"-", "0.8685224809824379`"}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.978026451688295*^9, 3.978026808198977*^9, 3.978026868670436*^9, {
   3.9780269093669*^9, 3.9780269354162207`*^9}, 3.978027280670052*^9, 
   3.978027663780684*^9, 3.978030426310503*^9, 3.978031158785578*^9, 
   3.978031332864462*^9, 3.978031535323908*^9},
 CellLabel->
  "During evaluation of \
In[3537]:=",ExpressionUUID->"d5dde40b-7b3e-406a-aa43-ab4a713c1f3d"],

Cell[BoxData["\<\"First 10 states:\"\>"], "Print",
 CellChangeTimes->{
  3.978026451688295*^9, 3.978026808198977*^9, 3.978026868670436*^9, {
   3.9780269093669*^9, 3.9780269354162207`*^9}, 3.978027280670052*^9, 
   3.978027663780684*^9, 3.978030426310503*^9, 3.978031158785578*^9, 
   3.978031332864462*^9, 3.9780315399505167`*^9},
 CellLabel->
  "During evaluation of \
In[3537]:=",ExpressionUUID->"a87226f0-b590-41b9-9560-5042683a13b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "0"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.978026451688295*^9, 3.978026808198977*^9, 3.978026868670436*^9, {
   3.9780269093669*^9, 3.9780269354162207`*^9}, 3.978027280670052*^9, 
   3.978027663780684*^9, 3.978030426310503*^9, 3.978031158785578*^9, 
   3.978031332864462*^9, 3.978031539952312*^9},
 CellLabel->
  "During evaluation of \
In[3537]:=",ExpressionUUID->"f0d3a71d-8f0e-402c-ba65-9fd93b8be23c"],

Cell[BoxData["\<\"\\nState frequencies:\"\>"], "Print",
 CellChangeTimes->{
  3.978026451688295*^9, 3.978026808198977*^9, 3.978026868670436*^9, {
   3.9780269093669*^9, 3.9780269354162207`*^9}, 3.978027280670052*^9, 
   3.978027663780684*^9, 3.978030426310503*^9, 3.978031158785578*^9, 
   3.978031332864462*^9, 3.978031539975244*^9},
 CellLabel->
  "During evaluation of \
In[3537]:=",ExpressionUUID->"e128237d-275c-47e2-8cc0-a9f410d73ab2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "0"}], "}"}], "\[Rule]", "1897"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "3", ",", "0"}], "}"}], "\[Rule]", "2502"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "0", ",", "3"}], "}"}], "\[Rule]", "2721"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "0", ",", "1"}], "}"}], "\[Rule]", "1906"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "0", ",", "1"}], "}"}], "\[Rule]", "1535"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "1", ",", "0"}], "}"}], "\[Rule]", "1999"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "3", ",", "1", ",", "2"}], "}"}], "\[Rule]", "2472"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "3", ",", "2", ",", "1"}], "}"}], "\[Rule]", "1733"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "2", ",", "3", ",", "1"}], "}"}], "\[Rule]", "2298"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "2", ",", "0"}], "}"}], "\[Rule]", "1874"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "0", ",", "2"}], "}"}], "\[Rule]", "2272"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "1", ",", "2", ",", "0"}], "}"}], "\[Rule]", "2545"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "3", ",", "2"}], "}"}], "\[Rule]", "1935"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], "\[Rule]", "1707"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "2", ",", "1", ",", "3"}], "}"}], "\[Rule]", "2502"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "0", ",", "1", ",", "3"}], "}"}], "\[Rule]", "2214"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "0", ",", "3", ",", "1"}], "}"}], "\[Rule]", "2501"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "0", ",", "1", ",", "2"}], "}"}], "\[Rule]", "1855"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "0", ",", "3"}], "}"}], "\[Rule]", "1827"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "1", ",", "0"}], "}"}], "\[Rule]", "1697"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "0", ",", "2", ",", "1"}], "}"}], "\[Rule]", "2747"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "3", ",", "2"}], "}"}], "\[Rule]", "1493"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "1", ",", "0", ",", "2"}], "}"}], "\[Rule]", "1938"}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "2", ",", "3"}], "}"}], "\[Rule]", 
    "1831"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.978026451688295*^9, 3.978026808198977*^9, 3.978026868670436*^9, {
   3.9780269093669*^9, 3.9780269354162207`*^9}, 3.978027280670052*^9, 
   3.978027663780684*^9, 3.978030426310503*^9, 3.978031158785578*^9, 
   3.978031332864462*^9, 3.978031539976852*^9},
 CellLabel->
  "During evaluation of \
In[3537]:=",ExpressionUUID->"9f96d894-6aed-4f74-ba33-2347bb780f98"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"BOLTZMANN", " ", "DISTRIBUTION", " ", "ANALYSIS"}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "=="}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Step", " ", "1"}], ":", 
    RowBox[{
    "Calculate", " ", "energy", " ", "for", " ", "each", " ", "state"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"energies", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NumericalEnergy", "[", 
        RowBox[{"states", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Step", " ", "2"}], "&"}], " ", "3"}], ":", 
     RowBox[{"Calculate", " ", "Boltzmann", " ", "distribution"}]}], "*)"}], 
   RowBox[{
    RowBox[{"boltzmannWeights", "=", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[Beta]Num"}], "*", "energies"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"partitionFunction", "=", 
     RowBox[{"Total", "[", "boltzmannWeights", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"theoreticalProbs", "=", 
     RowBox[{"boltzmannWeights", "/", "partitionFunction"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Step", " ", "4"}], ":", 
     RowBox[{
      RowBox[{
      "Get", " ", "observed", " ", "probabilities", " ", "from", " ", 
       "simulation"}], "-", "FIXED"}]}], "*)"}], 
   RowBox[{
    RowBox[{"observedCounts", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"stateCounts", ",", 
           RowBox[{"states", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"stateCounts", "[", 
          RowBox[{"states", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Observed counts: \>\"", ",", "observedCounts"}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Total observations: \>\"", ",", 
      RowBox[{"Total", "[", "observedCounts", "]"}]}], "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Only", " ", "calculate", " ", "probabilities", " ", "if", " ", "we", " ",
      "have", " ", "observations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", "observedCounts", "]"}], ">", "0"}], ",", 
      RowBox[{"observedProbs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"observedCounts", "/", 
         RowBox[{"Total", "[", "observedCounts", "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<ERROR: No observations found!\>\"", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"observedProbs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "states", "]"}], "}"}]}], "]"}]}], ";"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Scatter", " ", 
     RowBox[{"plot", ":", 
      RowBox[{"theory", " ", "vs", " ", "observed"}]}]}], "*)"}], 
   RowBox[{
    RowBox[{"scatterPlot", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"theoreticalProbs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"observedProbs", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"PointSize", "[", "0.015", "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "->", "\"\<Boltzmann Theory vs Simulation\>\""}], 
       ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Theoretical Probability\>\"", 
          ",", "\"\<Observed Probability\>\""}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "->", "1"}], ",", 
       RowBox[{"Epilog", "->", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Gray", ",", 
          RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", "theoreticalProbs", "]"}], ",", 
               RowBox[{"Max", "[", "theoreticalProbs", "]"}]}], "}"}]}], 
            "}"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Max", "[", "theoreticalProbs", "]"}], "*", "1.1"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Max", "[", "observedProbs", "]"}], "*", "1.1"}]}], 
           "}"}]}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Calculate", " ", "correlation", " ", "coefficient"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"correlation", "=", 
     RowBox[{"Correlation", "[", 
      RowBox[{"theoreticalProbs", ",", "observedProbs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\\n\>\"", "<>", 
      RowBox[{"StringRepeat", "[", 
       RowBox[{"\"\<=\>\"", ",", "60"}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<CORRELATION ANALYSIS\>\"", "]"}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"StringRepeat", "[", 
      RowBox[{"\"\<=\>\"", ",", "60"}], "]"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Pearson correlation coefficient: \>\"", ",", 
      RowBox[{"NumberForm", "[", 
       RowBox[{"correlation", ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "4"}], "}"}]}], "]"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<\\n\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "scatterPlot", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.978026535734852*^9, {3.978031339014819*^9, 3.978031340564597*^9}},
 CellLabel->
  "In[3555]:=",ExpressionUUID->"67ceaacb-ba7e-4fed-b0e7-e3a34d3c8029"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Observed counts: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1897", ",", "1874", ",", "2502", ",", "1999", ",", "2545", ",", "1697", ",",
      "2721", ",", "2272", ",", "1827", ",", "1535", ",", "1938", ",", "1906",
      ",", "1831", ",", "1493", ",", "2214", ",", "2501", ",", "1855", ",", 
     "2747", ",", "1707", ",", "1935", ",", "2502", ",", "2298", ",", "2472", 
     ",", "1733"}], "}"}]}],
  SequenceForm[
  "Observed counts: ", {1897, 1874, 2502, 1999, 2545, 1697, 2721, 2272, 1827, 
   1535, 1938, 1906, 1831, 1493, 2214, 2501, 1855, 2747, 1707, 1935, 2502, 
   2298, 2472, 1733}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9780265366040154`*^9, 3.978026814407864*^9, 3.978026876175872*^9, {
   3.9780269170670853`*^9, 3.978026941243802*^9}, 3.978027287447357*^9, 
   3.978027671400169*^9, 3.978030434398942*^9, 3.978031164966823*^9, {
   3.97803134228201*^9, 3.978031349092325*^9}, 3.978031543351259*^9},
 CellLabel->
  "During evaluation of \
In[3555]:=",ExpressionUUID->"e22a050d-97a3-43a8-8567-3090ee9f4749"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total observations: \"\>", "\[InvisibleSpace]", "50001"}],
  SequenceForm["Total observations: ", 50001],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9780265366040154`*^9, 3.978026814407864*^9, 3.978026876175872*^9, {
   3.9780269170670853`*^9, 3.978026941243802*^9}, 3.978027287447357*^9, 
   3.978027671400169*^9, 3.978030434398942*^9, 3.978031164966823*^9, {
   3.97803134228201*^9, 3.978031349092325*^9}, 3.978031543352892*^9},
 CellLabel->
  "During evaluation of \
In[3555]:=",ExpressionUUID->"d6b97ef4-7e4a-4561-9853-92e5545a1957"],

Cell[BoxData["\<\"\\n=========================================================\
===\"\>"], "Print",
 CellChangeTimes->{
  3.9780265366040154`*^9, 3.978026814407864*^9, 3.978026876175872*^9, {
   3.9780269170670853`*^9, 3.978026941243802*^9}, 3.978027287447357*^9, 
   3.978027671400169*^9, 3.978030434398942*^9, 3.978031164966823*^9, {
   3.97803134228201*^9, 3.978031349092325*^9}, 3.978031543390903*^9},
 CellLabel->
  "During evaluation of \
In[3555]:=",ExpressionUUID->"94bf2e62-655f-471f-9fc3-cd207ade0295"],

Cell[BoxData["\<\"CORRELATION ANALYSIS\"\>"], "Print",
 CellChangeTimes->{
  3.9780265366040154`*^9, 3.978026814407864*^9, 3.978026876175872*^9, {
   3.9780269170670853`*^9, 3.978026941243802*^9}, 3.978027287447357*^9, 
   3.978027671400169*^9, 3.978030434398942*^9, 3.978031164966823*^9, {
   3.97803134228201*^9, 3.978031349092325*^9}, 3.9780315433928947`*^9},
 CellLabel->
  "During evaluation of \
In[3555]:=",ExpressionUUID->"70976cf4-aa92-43a1-9f27-b06c4aea20b3"],

Cell[BoxData["\<\"============================================================\
\"\>"], "Print",
 CellChangeTimes->{
  3.9780265366040154`*^9, 3.978026814407864*^9, 3.978026876175872*^9, {
   3.9780269170670853`*^9, 3.978026941243802*^9}, 3.978027287447357*^9, 
   3.978027671400169*^9, 3.978030434398942*^9, 3.978031164966823*^9, {
   3.97803134228201*^9, 3.978031349092325*^9}, 3.978031543393815*^9},
 CellLabel->
  "During evaluation of \
In[3555]:=",ExpressionUUID->"83b2eee1-f5df-4db4-903e-dad8ae6630a3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Pearson correlation coefficient: \"\>", "\[InvisibleSpace]", 
   TagBox[
    InterpretationBox[
     StyleBox["\<\"0.9164\"\>",
      ShowStringCharacters->False],
     0.9163955338996571,
     AutoDelete->True],
    NumberForm[#, {5, 4}]& ]}],
  SequenceForm["Pearson correlation coefficient: ", 
   NumberForm[0.9163955338996571, {5, 4}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9780265366040154`*^9, 3.978026814407864*^9, 3.978026876175872*^9, {
   3.9780269170670853`*^9, 3.978026941243802*^9}, 3.978027287447357*^9, 
   3.978027671400169*^9, 3.978030434398942*^9, 3.978031164966823*^9, {
   3.97803134228201*^9, 3.978031349092325*^9}, 3.978031543394808*^9},
 CellLabel->
  "During evaluation of \
In[3555]:=",ExpressionUUID->"29274bdb-0657-48ef-af50-7847e66e91d9"],

Cell[BoxData["\<\"\\n\"\>"], "Print",
 CellChangeTimes->{
  3.9780265366040154`*^9, 3.978026814407864*^9, 3.978026876175872*^9, {
   3.9780269170670853`*^9, 3.978026941243802*^9}, 3.978027287447357*^9, 
   3.978027671400169*^9, 3.978030434398942*^9, 3.978031164966823*^9, {
   3.97803134228201*^9, 3.978031349092325*^9}, 3.9780315433957853`*^9},
 CellLabel->
  "During evaluation of \
In[3555]:=",ExpressionUUID->"1afa2ced-b00c-4e0b-b458-dd2525eec0d2"],

Cell[BoxData[
 GraphicsBox[{{}, 
   InterpretationBox[{
     TagBox[
      TagBox[
       {RGBColor[1, 0, 0], PointSize[0.015], AbsoluteThickness[2], 
        PointBox[CompressedData["
1:eJxTTMoPSmViYGCQAGIQ7XGzeLmtzCJ7Ee2mDUdzFttHH+Puz9VYYu9iOf9r
lcFi+/iEhpMhu1fa34yJNNo2byVc/oLy3Bj1iiVw+YUbo/Ly+FfZw8xL9w1a
WpewEC7fLZG2+vSd1XD+zlfVT085L4er33hheo7b1kVwfkf4jtcr8ufD7ftW
ynDM/gbCfXOvn4+NbUHwa57M3XloP0L/ve0Ws8omz4PLbz+9uOPA6mVw+59f
F5cXn7MSrt4++lD7mn+L4PImM3kXfFZYA5d/XPcwdWvVQrh5cs+te5Iu4A6f
xGzlW5/al8Pl006s/iAYgLCv+39H1N19C+0Bt0W6mw==
         "]]},
       Annotation[#, "Charting`Private`Tag#1"]& ],
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
     StyleBox[
      DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
        Slot["HighlightElements"], 
        Slot["LayoutOptions"], 
        Slot["Meta"], 
        Charting`HighlightActionFunction["DynamicHighlight", {{
           Annotation[{
             Directive[
              AbsoluteThickness[2], 
              RGBColor[1, 0, 0], 
              PointSize[0.015]], 
             Point[CompressedData["
1:eJxTTMoPSmViYGCQAGIQ7XGzeLmtzCJ7Ee2mDUdzFttHH+Puz9VYYu9iOf9r
lcFi+/iEhpMhu1fa34yJNNo2byVc/oLy3Bj1iiVw+YUbo/Ly+FfZw8xL9w1a
WpewEC7fLZG2+vSd1XD+zlfVT085L4er33hheo7b1kVwfkf4jtcr8ufD7ftW
ynDM/gbCfXOvn4+NbUHwa57M3XloP0L/ve0Ws8omz4PLbz+9uOPA6mVw+59f
F5cXn7MSrt4++lD7mn+L4PImM3kXfFZYA5d/XPcwdWvVQrh5cs+te5Iu4A6f
xGzlW5/al8Pl006s/iAYgLCv+39H1N19C+0Bt0W6mw==
              "]]}, "Charting`Private`Tag#1"]}}, <|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0., 0.055283083493311146`}, {0., 
             0.06043279134417312}}, 
            "Frame" -> {{False, False}, {False, False}}, 
            "AxesOrigin" -> {0, 0}, "ImageSize" -> {576, 576}, 
            "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 1, 
            "DefaultStyle" -> {
              Directive[
               AbsoluteThickness[2], 
               RGBColor[1, 0, 0], 
               PointSize[0.015]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0., 0.055283083493311146`}, {0., 
            0.06043279134417312}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0}, "ImageSize" -> {576, 576}, 
           "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 1, 
           "DefaultStyle" -> {
             Directive[
              AbsoluteThickness[2], 
              RGBColor[1, 0, 0], 
              PointSize[0.015]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListPlot, "GroupHighlight" -> False|>|>],
       ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
        4.503599627370496*^15, -4.503599627370496*^15}}],
      Selectable->False]},
    Annotation[{{
       Annotation[{
         Directive[
          AbsoluteThickness[2], 
          RGBColor[1, 0, 0], 
          PointSize[0.015]], 
         Point[CompressedData["
1:eJxTTMoPSmViYGCQAGIQ7XGzeLmtzCJ7Ee2mDUdzFttHH+Puz9VYYu9iOf9r
lcFi+/iEhpMhu1fa34yJNNo2byVc/oLy3Bj1iiVw+YUbo/Ly+FfZw8xL9w1a
WpewEC7fLZG2+vSd1XD+zlfVT085L4er33hheo7b1kVwfkf4jtcr8ufD7ftW
ynDM/gbCfXOvn4+NbUHwa57M3XloP0L/ve0Ws8omz4PLbz+9uOPA6mVw+59f
F5cXn7MSrt4++lD7mn+L4PImM3kXfFZYA5d/XPcwdWvVQrh5cs+te5Iu4A6f
xGzlW5/al8Pl006s/iAYgLCv+39H1N19C+0Bt0W6mw==
          "]]}, "Charting`Private`Tag#1"]}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
      "LayoutOptions" -> <|
       "PanelPlotLayout" -> <||>, 
        "PlotRange" -> {{0., 0.055283083493311146`}, {0., 
         0.06043279134417312}}, "Frame" -> {{False, False}, {False, False}}, 
        "AxesOrigin" -> {0, 0}, "ImageSize" -> {576, 576}, 
        "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 1, 
        "DefaultStyle" -> {
          Directive[
           AbsoluteThickness[2], 
           RGBColor[1, 0, 0], 
           PointSize[0.015]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        ListPlot, "GroupHighlight" -> False|>|>, 
     "DynamicHighlight"]], {{}, {}}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"Theoretical Probability\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox["\"Observed Probability\"", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DefaultBaseStyle->{"PlotGraphics", "Graphics"},
  DisplayFunction->Identity,
  Epilog->{
    Dashing[{Small, Small}], 
    GrayLevel[0.5], 
    Thickness[0.002], 
    LineBox[{{0, 0}, {0.050257348630282854`, 0.050257348630282854`}}]},
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.24, 0.6, 0.8], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.95, 0.627, 0.1425], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.455, 0.7, 0.21], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.578, 0.51, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.4, 0.64, 1.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1., 0.75, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.8, 0.4, 0.76], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.637, 0.65, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> Automatic, 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "IncludeHighlighting" -> "CurrentPoint", "HighlightStyle" -> Automatic, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotInteractivity:>True,
  PlotLabel->FormBox["\"Boltzmann Theory vs Simulation\"", TraditionalForm],
  PlotRange->{{0., 0.055283083493311146`}, {0., 0.06043279134417312}},
  PlotRangeClipping->True,
  PlotRangePadding->{{None, None}, {None, None}},
  Ticks->{Automatic, Automatic}]], "Print",
 CellChangeTimes->{
  3.9780265366040154`*^9, 3.978026814407864*^9, 3.978026876175872*^9, {
   3.9780269170670853`*^9, 3.978026941243802*^9}, 3.978027287447357*^9, 
   3.978027671400169*^9, 3.978030434398942*^9, 3.978031164966823*^9, {
   3.97803134228201*^9, 3.978031349092325*^9}, 3.9780315434030333`*^9},
 CellLabel->
  "During evaluation of \
In[3555]:=",ExpressionUUID->"d193da87-bd89-4aaa-8943-740f1c2b3afe"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 676},
WindowMargins->{{170, Automatic}, {Automatic, 37}},
FrontEndVersion->"14.3 for Mac OS X x86 (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3868fc37-8808-4f23-93a3-a012843acb72"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 169, 3, 67, "Chapter",ExpressionUUID->"1a73e5e0-7f3a-4441-b576-ba0962102138"],
Cell[CellGroupData[{
Cell[770, 29, 54616, 1384, 6259, "Input",ExpressionUUID->"3f8050e8-6e84-43e9-98ef-ffdaef135efa"],
Cell[CellGroupData[{
Cell[55411, 1417, 957, 18, 23, "Print",ExpressionUUID->"43060ceb-1278-4137-be6f-04b1fa8f9407"],
Cell[56371, 1437, 973, 18, 23, "Print",ExpressionUUID->"c0c54438-110d-430a-b100-d7556e647d54"],
Cell[57347, 1457, 856, 14, 23, "Print",ExpressionUUID->"a1c19a56-1511-4dfd-9b9a-40902c6748a9"],
Cell[58206, 1473, 1390, 31, 66, "Print",ExpressionUUID->"1cc54889-8423-4ad0-997a-981c8eca03f3"],
Cell[59599, 1506, 993, 18, 23, "Print",ExpressionUUID->"7b5eb673-73e9-48af-8e03-3dd9b5f6fd95"],
Cell[60595, 1526, 1489, 32, 23, "Print",ExpressionUUID->"6e568e67-492f-49bb-8f9c-ec4f8786cd28"],
Cell[62087, 1560, 1378, 26, 41, "Print",ExpressionUUID->"0597bd77-32d6-4cc6-9bcd-6bfab8ddc17b"],
Cell[63468, 1588, 865, 14, 23, "Print",ExpressionUUID->"af0f77a0-4650-4fd3-80fe-1684207c5d22"],
Cell[64336, 1604, 865, 14, 23, "Print",ExpressionUUID->"448962c0-1b41-4d0c-a782-af3bd91e823d"],
Cell[65204, 1620, 39935, 1042, 251, "Print",ExpressionUUID->"af67b837-13f9-4b8e-b4ae-c396ef82467d"],
Cell[105142, 2664, 885, 14, 23, "Print",ExpressionUUID->"cbf7e8da-4d52-47a7-9c88-72c4eb181709"],
Cell[106030, 2680, 1007, 18, 23, "Print",ExpressionUUID->"d0da1b36-8909-4b1a-af84-425bd7ac001a"],
Cell[107040, 2700, 1157, 21, 23, "Print",ExpressionUUID->"6320f8ee-e2dc-4a54-b5b2-7e160a984f88"],
Cell[108200, 2723, 892, 14, 23, "Print",ExpressionUUID->"7a070ca7-7005-47f1-a08b-d8d164fb6b33"],
Cell[109095, 2739, 1127, 22, 41, "Print",ExpressionUUID->"62f22f3c-7fa3-474d-bcd5-48b462dc82b7"],
Cell[110225, 2763, 880, 14, 41, "Print",ExpressionUUID->"a8636527-141c-416b-997f-9d9c555ca5c0"],
Cell[111108, 2779, 27151, 589, 608, "Print",ExpressionUUID->"de632962-8360-4f13-9c92-ce9ebc9414e4"],
Cell[138262, 3370, 881, 14, 41, "Print",ExpressionUUID->"aca1bb1f-4b31-4c35-822d-b2a0c77cfeb0"],
Cell[139146, 3386, 27149, 589, 608, "Print",ExpressionUUID->"5d506d47-2432-4cb2-8986-cce8bac59ce8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[166344, 3981, 8586, 224, 1071, "Input",ExpressionUUID->"f017be70-9962-4837-aeec-177be8cb1f9b"],
Cell[CellGroupData[{
Cell[174955, 4209, 441, 8, 23, "Print",ExpressionUUID->"c462d7a6-fe56-4933-9286-64363760dccb"],
Cell[175399, 4219, 1333, 33, 66, "Print",ExpressionUUID->"d5dde40b-7b3e-406a-aa43-ab4a713c1f3d"],
Cell[176735, 4254, 438, 8, 23, "Print",ExpressionUUID->"a87226f0-b590-41b9-9560-5042683a13b0"],
Cell[177176, 4264, 1228, 30, 41, "Print",ExpressionUUID->"f0d3a71d-8f0e-402c-ba65-9fd93b8be23c"],
Cell[178407, 4296, 441, 8, 41, "Print",ExpressionUUID->"e128237d-275c-47e2-8cc0-a9f410d73ab2"],
Cell[178851, 4306, 3271, 106, 98, "Print",ExpressionUUID->"9f96d894-6aed-4f74-ba33-2347bb780f98"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[182171, 4418, 7275, 196, 887, "Input",ExpressionUUID->"67ceaacb-ba7e-4fed-b0e7-e3a34d3c8029"],
Cell[CellGroupData[{
Cell[189471, 4618, 1107, 22, 41, "Print",ExpressionUUID->"e22a050d-97a3-43a8-8567-3090ee9f4749"],
Cell[190581, 4642, 597, 12, 23, "Print",ExpressionUUID->"d6b97ef4-7e4a-4561-9853-92e5545a1957"],
Cell[191181, 4656, 512, 9, 41, "Print",ExpressionUUID->"94bf2e62-655f-471f-9fc3-cd207ade0295"],
Cell[191696, 4667, 469, 8, 23, "Print",ExpressionUUID->"70976cf4-aa92-43a1-9f27-b06c4aea20b3"],
Cell[192168, 4677, 509, 9, 23, "Print",ExpressionUUID->"83b2eee1-f5df-4db4-903e-dad8ae6630a3"],
Cell[192680, 4688, 833, 20, 23, "Print",ExpressionUUID->"29274bdb-0657-48ef-af50-7847e66e91d9"],
Cell[193516, 4710, 452, 8, 41, "Print",ExpressionUUID->"1afa2ced-b00c-4e0b-b458-dd2525eec0d2"],
Cell[193971, 4720, 9654, 231, 475, "Print",ExpressionUUID->"d193da87-bd89-4aaa-8943-740f1c2b3afe"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

